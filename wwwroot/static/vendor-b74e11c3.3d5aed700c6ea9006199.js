"use strict";(self.webpackChunkui_react=self.webpackChunkui_react||[]).push([[3208],{36022:(e,t,i)=>{var s=i(5976),o=i(1432),n=i(16830),r=i(50187),a=i(24314),d=i(3860),l=i(54530);class c{constructor(e,t,i){this.selection=e,this.targetPosition=t,this.copy=i,this.targetSelection=null}getEditOperations(e,t){const i=e.getValueInRange(this.selection);this.copy||t.addEditOperation(this.selection,null),t.addEditOperation(new a.e(this.targetPosition.lineNumber,this.targetPosition.column,this.targetPosition.lineNumber,this.targetPosition.column),i),!this.selection.containsPosition(this.targetPosition)||this.copy&&(this.selection.getEndPosition().equals(this.targetPosition)||this.selection.getStartPosition().equals(this.targetPosition))?this.copy?this.targetSelection=new d.Y(this.targetPosition.lineNumber,this.targetPosition.column,this.selection.endLineNumber-this.selection.startLineNumber+this.targetPosition.lineNumber,this.selection.startLineNumber===this.selection.endLineNumber?this.targetPosition.column+this.selection.endColumn-this.selection.startColumn:this.selection.endColumn):this.targetPosition.lineNumber>this.selection.endLineNumber?this.targetSelection=new d.Y(this.targetPosition.lineNumber-this.selection.endLineNumber+this.selection.startLineNumber,this.targetPosition.column,this.targetPosition.lineNumber,this.selection.startLineNumber===this.selection.endLineNumber?this.targetPosition.column+this.selection.endColumn-this.selection.startColumn:this.selection.endColumn):this.targetPosition.lineNumber<this.selection.endLineNumber?this.targetSelection=new d.Y(this.targetPosition.lineNumber,this.targetPosition.column,this.targetPosition.lineNumber+this.selection.endLineNumber-this.selection.startLineNumber,this.selection.startLineNumber===this.selection.endLineNumber?this.targetPosition.column+this.selection.endColumn-this.selection.startColumn:this.selection.endColumn):this.selection.endColumn<=this.targetPosition.column?this.targetSelection=new d.Y(this.targetPosition.lineNumber-this.selection.endLineNumber+this.selection.startLineNumber,(this.selection.startLineNumber,this.selection.endLineNumber,this.targetPosition.column-this.selection.endColumn+this.selection.startColumn),this.targetPosition.lineNumber,this.selection.startLineNumber===this.selection.endLineNumber?this.targetPosition.column:this.selection.endColumn):this.targetSelection=new d.Y(this.targetPosition.lineNumber-this.selection.endLineNumber+this.selection.startLineNumber,this.targetPosition.column,this.targetPosition.lineNumber,this.targetPosition.column+this.selection.endColumn-this.selection.startColumn):this.targetSelection=this.selection}computeCursorState(e,t){return this.targetSelection}}function h(e){return o.dz?e.altKey:e.ctrlKey}class u extends s.JT{constructor(e){super(),this._editor=e,this._dndDecorationIds=this._editor.createDecorationsCollection(),this._register(this._editor.onMouseDown((e=>this._onEditorMouseDown(e)))),this._register(this._editor.onMouseUp((e=>this._onEditorMouseUp(e)))),this._register(this._editor.onMouseDrag((e=>this._onEditorMouseDrag(e)))),this._register(this._editor.onMouseDrop((e=>this._onEditorMouseDrop(e)))),this._register(this._editor.onMouseDropCanceled((()=>this._onEditorMouseDropCanceled()))),this._register(this._editor.onKeyDown((e=>this.onEditorKeyDown(e)))),this._register(this._editor.onKeyUp((e=>this.onEditorKeyUp(e)))),this._register(this._editor.onDidBlurEditorWidget((()=>this.onEditorBlur()))),this._register(this._editor.onDidBlurEditorText((()=>this.onEditorBlur()))),this._mouseDown=!1,this._modifierPressed=!1,this._dragSelection=null}onEditorBlur(){this._removeDecoration(),this._dragSelection=null,this._mouseDown=!1,this._modifierPressed=!1}onEditorKeyDown(e){this._editor.getOption(35)&&!this._editor.getOption(22)&&(h(e)&&(this._modifierPressed=!0),this._mouseDown&&h(e)&&this._editor.updateOptions({mouseStyle:"copy"}))}onEditorKeyUp(e){this._editor.getOption(35)&&!this._editor.getOption(22)&&(h(e)&&(this._modifierPressed=!1),this._mouseDown&&e.keyCode===u.TRIGGER_KEY_VALUE&&this._editor.updateOptions({mouseStyle:"default"}))}_onEditorMouseDown(e){this._mouseDown=!0}_onEditorMouseUp(e){this._mouseDown=!1,this._editor.updateOptions({mouseStyle:"text"})}_onEditorMouseDrag(e){const t=e.target;if(null===this._dragSelection){const e=(this._editor.getSelections()||[]).filter((e=>t.position&&e.containsPosition(t.position)));if(1!==e.length)return;this._dragSelection=e[0]}h(e.event)?this._editor.updateOptions({mouseStyle:"copy"}):this._editor.updateOptions({mouseStyle:"default"}),t.position&&(this._dragSelection.containsPosition(t.position)?this._removeDecoration():this.showAt(t.position))}_onEditorMouseDropCanceled(){this._editor.updateOptions({mouseStyle:"text"}),this._removeDecoration(),this._dragSelection=null,this._mouseDown=!1}_onEditorMouseDrop(e){if(e.target&&(this._hitContent(e.target)||this._hitMargin(e.target))&&e.target.position){const t=new r.L(e.target.position.lineNumber,e.target.position.column);if(null===this._dragSelection){let i=null;if(e.event.shiftKey){const e=this._editor.getSelection();if(e){const{selectionStartLineNumber:s,selectionStartColumn:o}=e;i=[new d.Y(s,o,t.lineNumber,t.column)]}}else i=(this._editor.getSelections()||[]).map((e=>e.containsPosition(t)?new d.Y(t.lineNumber,t.column,t.lineNumber,t.column):e));this._editor.setSelections(i||[],"mouse",3)}else(!this._dragSelection.containsPosition(t)||(h(e.event)||this._modifierPressed)&&(this._dragSelection.getEndPosition().equals(t)||this._dragSelection.getStartPosition().equals(t)))&&(this._editor.pushUndoStop(),this._editor.executeCommand(u.ID,new c(this._dragSelection,t,h(e.event)||this._modifierPressed)),this._editor.pushUndoStop())}this._editor.updateOptions({mouseStyle:"text"}),this._removeDecoration(),this._dragSelection=null,this._mouseDown=!1}showAt(e){this._dndDecorationIds.set([{range:new a.e(e.lineNumber,e.column,e.lineNumber,e.column),options:u._DECORATION_OPTIONS}]),this._editor.revealPosition(e,1)}_removeDecoration(){this._dndDecorationIds.clear()}_hitContent(e){return 6===e.type||7===e.type}_hitMargin(e){return 2===e.type||3===e.type||4===e.type}dispose(){this._removeDecoration(),this._dragSelection=null,this._mouseDown=!1,this._modifierPressed=!1,super.dispose()}}u.ID="editor.contrib.dragAndDrop",u.TRIGGER_KEY_VALUE=o.dz?6:5,u._DECORATION_OPTIONS=l.qx.register({description:"dnd-target",className:"dnd-target"}),(0,n._K)(u.ID,u,2)},76917:(e,t,i)=>{var s=i(71050),o=i(98401),n=i(70666),r=i(88216),a=i(30335);i(94565).P.registerCommand("_executeDocumentSymbolProvider",(async function(e,...t){const[i]=t;(0,o.p_)(n.o.isUri(i));const d=e.get(a.Je),l=e.get(r.S),c=await l.createModelReference(i);try{return(await d.getOrCreate(c.object.textEditorModel,s.Ts.None)).getTopLevelSymbols()}finally{c.dispose()}}))},30335:(e,t,i)=>{i.d(t,{C3:()=>w,H3:()=>P,Je:()=>b,sT:()=>y});var s=i(9488),o=i(71050),n=i(17301),r=i(53725),a=i(43702),d=i(50187),l=i(24314),c=i(88191),h=i(72065),u=i(65026),p=i(73733),g=i(5976),m=i(71922),f=function(e,t,i,s){var o,n=arguments.length,r=n<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,i,s);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(n<3?o(r):n>3?o(t,i,r):o(t,i))||r);return n>3&&r&&Object.defineProperty(t,i,r),r},v=function(e,t){return function(i,s){t(i,s,e)}};class _{remove(){var e;null===(e=this.parent)||void 0===e||e.children.delete(this.id)}static findId(e,t){let i;"string"==typeof e?i=`${t.id}/${e}`:(i=`${t.id}/${e.name}`,void 0!==t.children.get(i)&&(i=`${t.id}/${e.name}_${e.range.startLineNumber}_${e.range.startColumn}`));let s=i;for(let e=0;void 0!==t.children.get(s);e++)s=`${i}_${e}`;return s}static empty(e){return 0===e.children.size}}class y extends _{constructor(e,t,i){super(),this.id=e,this.parent=t,this.symbol=i,this.children=new Map}}class P extends _{constructor(e,t,i,s){super(),this.id=e,this.parent=t,this.label=i,this.order=s,this.children=new Map}}class w extends _{static create(e,t,i){const r=new o.AU(i),a=new w(t.uri),d=e.ordered(t),l=d.map(((e,i)=>{var s;const o=_.findId(`provider_${i}`,a),d=new P(o,a,null!==(s=e.displayName)&&void 0!==s?s:"Unknown Outline Provider",i);return Promise.resolve(e.provideDocumentSymbols(t,r.token)).then((e=>{for(const t of e||[])w._makeOutlineElement(t,d);return d}),(e=>((0,n.Cp)(e),d))).then((e=>{_.empty(e)?e.remove():a._groups.set(o,e)}))})),c=e.onDidChange((()=>{const i=e.ordered(t);(0,s.fS)(i,d)||r.cancel()}));return Promise.all(l).then((()=>r.token.isCancellationRequested&&!i.isCancellationRequested?w.create(e,t,i):a._compact())).finally((()=>{r.dispose(),c.dispose(),r.dispose()}))}static _makeOutlineElement(e,t){const i=_.findId(e,t),s=new y(i,t,e);if(e.children)for(const t of e.children)w._makeOutlineElement(t,s);t.children.set(s.id,s)}constructor(e){super(),this.uri=e,this.id="root",this.parent=void 0,this._groups=new Map,this.children=new Map,this.id="root",this.parent=void 0}_compact(){let e=0;for(const[t,i]of this._groups)0===i.children.size?this._groups.delete(t):e+=1;if(1!==e)this.children=this._groups;else{const e=r.$.first(this._groups.values());for(const[,t]of e.children)t.parent=this,this.children.set(t.id,t)}return this}getTopLevelSymbols(){const e=[];for(const t of this.children.values())t instanceof y?e.push(t.symbol):e.push(...r.$.map(t.children.values(),(e=>e.symbol)));return e.sort(((e,t)=>l.e.compareRangesUsingStarts(e.range,t.range)))}asListOfDocumentSymbols(){const e=this.getTopLevelSymbols(),t=[];return w._flattenDocumentSymbols(t,e,""),t.sort(((e,t)=>d.L.compare(l.e.getStartPosition(e.range),l.e.getStartPosition(t.range))||d.L.compare(l.e.getEndPosition(t.range),l.e.getEndPosition(e.range))))}static _flattenDocumentSymbols(e,t,i){for(const s of t)e.push({kind:s.kind,tags:s.tags,name:s.name,detail:s.detail,containerName:s.containerName||i,range:s.range,selectionRange:s.selectionRange,children:void 0}),s.children&&w._flattenDocumentSymbols(e,s.children,s.name)}}const b=(0,h.yh)("IOutlineModelService");let C=class{constructor(e,t,i){this._languageFeaturesService=e,this._disposables=new g.SL,this._cache=new a.z6(10,.7),this._debounceInformation=t.for(e.documentSymbolProvider,"DocumentSymbols",{min:350}),this._disposables.add(i.onModelRemoved((e=>{this._cache.delete(e.id)})))}dispose(){this._disposables.dispose()}async getOrCreate(e,t){const i=this._languageFeaturesService.documentSymbolProvider,n=i.ordered(e);let r=this._cache.get(e.id);if(!r||r.versionId!==e.getVersionId()||!(0,s.fS)(r.provider,n)){const t=new o.AU;r={versionId:e.getVersionId(),provider:n,promiseCnt:0,source:t,promise:w.create(i,e,t.token),model:void 0},this._cache.set(e.id,r);const s=Date.now();r.promise.then((t=>{r.model=t,this._debounceInformation.update(e,Date.now()-s)})).catch((t=>{this._cache.delete(e.id)}))}if(r.model)return r.model;r.promiseCnt+=1;const a=t.onCancellationRequested((()=>{0==--r.promiseCnt&&(r.source.cancel(),this._cache.delete(e.id))}));try{return await r.promise}finally{a.dispose()}}};C=f([v(0,m.p),v(1,c.A),v(2,p.q)],C),(0,u.z)(b,C,1)},57811:(e,t,i)=>{var s,o=i(85373),n=i(16830),r=i(29102),a=i(10637),d=i(24954),l=i(51512),c=i(63580);(0,n._K)(d.bO.ID,d.bO,0),(0,a.y)(l.vJ),(0,n.fK)(new class extends n._l{constructor(){super({id:d.iE,precondition:d.wS,kbOpts:{weight:100,primary:2137}})}runEditorCommand(e,t){var i;return null===(i=d.bO.get(t))||void 0===i?void 0:i.changePasteType()}}),(0,n.fK)(new class extends n._l{constructor(){super({id:"editor.hidePasteWidget",precondition:d.wS,kbOpts:{weight:100,primary:9}})}runEditorCommand(e,t){var i;null===(i=d.bO.get(t))||void 0===i||i.clearWidgets()}}),(0,n.Qr)(((s=class extends n.R6{constructor(){super({id:"editor.action.pasteAs",label:c.NC("pasteAs","Paste As..."),alias:"Paste As...",precondition:r.u.writable,metadata:{description:"Paste as",args:[{name:"args",schema:s.argsSchema}]}})}run(e,t,i){var s;let n="string"==typeof(null==i?void 0:i.kind)?i.kind:void 0;return!n&&i&&(n="string"==typeof i.id?i.id:void 0),null===(s=d.bO.get(t))||void 0===s?void 0:s.pasteAs(n?new o.o(n):void 0)}}).argsSchema={type:"object",properties:{kind:{type:"string",description:c.NC("pasteAs.kind","The kind of the paste edit to try applying. If not provided or there are multiple edits for this kind, the editor will show a picker.")}}},s)),(0,n.Qr)(class extends n.R6{constructor(){super({id:"editor.action.pasteAsText",label:c.NC("pasteAsText","Paste as Text"),alias:"Paste as Text",precondition:r.u.writable})}run(e,t){var i;return null===(i=d.bO.get(t))||void 0===i?void 0:i.pasteAs({providerId:l.f8.id})}})},24954:(e,t,i)=>{i.d(t,{bO:()=>R,iE:()=>O,wS:()=>A});var s,o=i(65321),n=i(9488),r=i(15393),a=i(73278),d=i(85373),l=i(5976),c=i(81170),h=i(1432),u=i(98e3),p=i(35715),g=i(92944),m=i(66007),f=i(24314),v=i(71204),_=i(71922),y=i(51512),P=i(91092),w=i(16467),b=i(4074),C=i(27753),D=i(63580),S=i(84972),E=i(93983),T=i(72065),k=i(90535),x=i(41157),N=i(50987),M=function(e,t,i,s){var o,n=arguments.length,r=n<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,i,s);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(n<3?o(r):n>3?o(t,i,r):o(t,i))||r);return n>3&&r&&Object.defineProperty(t,i,r),r},I=function(e,t){return function(i,s){t(i,s,e)}};const O="editor.changePasteType",A=new E.uy("pasteWidgetVisible",!1,(0,D.NC)("pasteWidgetVisible","Whether the paste widget is showing")),L="application/vnd.code.copyMetadata";let R=s=class extends l.JT{static get(e){return e.getContribution(s.ID)}constructor(e,t,i,s,n,r,a){super(),this._bulkEditService=i,this._clipboardService=s,this._languageFeaturesService=n,this._quickInputService=r,this._progressService=a,this._editor=e;const d=e.getContainerDomNode();this._register((0,o.nm)(d,"copy",(e=>this.handleCopy(e)))),this._register((0,o.nm)(d,"cut",(e=>this.handleCopy(e)))),this._register((0,o.nm)(d,"paste",(e=>this.handlePaste(e)),!0)),this._pasteProgressManager=this._register(new b.r("pasteIntoEditor",e,t)),this._postPasteWidgetManager=this._register(t.createInstance(N.p,"pasteIntoEditor",e,A,{id:O,label:(0,D.NC)("postPasteWidgetTitle","Show paste options...")}))}changePasteType(){this._postPasteWidgetManager.tryShowSelector()}pasteAs(e){this._editor.focus();try{this._pasteAsActionContext={preferred:e},(0,o.uP)().execCommand("paste")}finally{this._pasteAsActionContext=void 0}}clearWidgets(){this._postPasteWidgetManager.clear()}isPasteAsEnabled(){return this._editor.getOption(85).enabled&&!this._editor.getOption(91)}async finishedPaste(){await this._currentPasteOperation}handleCopy(e){var t,i;if(!this._editor.hasTextFocus())return;if(h.$L&&this._clipboardService.writeResources([]),!e.clipboardData||!this.isPasteAsEnabled())return;const o=this._editor.getModel(),a=this._editor.getSelections();if(!o||!(null==a?void 0:a.length))return;const d=this._editor.getOption(37);let l=a;const c=1===a.length&&a[0].isEmpty();if(c){if(!d)return;l=[new f.e(l[0].startLineNumber,1,l[0].startLineNumber,1+o.getLineLength(l[0].startLineNumber))]}const p=null===(t=this._editor._getViewModel())||void 0===t?void 0:t.getPlainTextToCopy(a,d,h.ED),m={multicursorText:Array.isArray(p)?p:null,pasteOnNewLine:c,mode:null},v=this._languageFeaturesService.documentPasteEditProvider.ordered(o).filter((e=>!!e.prepareDocumentPaste));if(!v.length)return void this.setCopyMetadata(e.clipboardData,{defaultPastePayload:m});const _=(0,g.B)(e.clipboardData),y=v.flatMap((e=>{var t;return null!==(t=e.copyMimeTypes)&&void 0!==t?t:[]})),P=(0,u.R)();this.setCopyMetadata(e.clipboardData,{id:P,providerCopyMimeTypes:y,defaultPastePayload:m});const w=(0,r.PG)((async e=>{const t=(0,n.kX)(await Promise.all(v.map((async t=>{try{return await t.prepareDocumentPaste(o,l,_,e)}catch(e){return}}))));t.reverse();for(const e of t)for(const[t,i]of e)_.replace(t,i);return _}));null===(i=s._currentCopyOperation)||void 0===i||i.dataTransferPromise.cancel(),s._currentCopyOperation={handle:P,dataTransferPromise:w}}async handlePaste(e){var t,i,s,o;if(!e.clipboardData||!this._editor.hasTextFocus())return;null===(t=C.O.get(this._editor))||void 0===t||t.closeMessage(),null===(i=this._currentPasteOperation)||void 0===i||i.cancel(),this._currentPasteOperation=void 0;const n=this._editor.getModel(),r=this._editor.getSelections();if(!(null==r?void 0:r.length)||!n)return;if(!this.isPasteAsEnabled()&&!this._pasteAsActionContext)return;const d=this.fetchCopyMetadata(e),l=(0,g.L)(e.clipboardData);l.delete(L);const h=[...e.clipboardData.types,...null!==(s=null==d?void 0:d.providerCopyMimeTypes)&&void 0!==s?s:[],c.v.uriList],u=this._languageFeaturesService.documentPasteEditProvider.ordered(n).filter((e=>{var t,i;const s=null===(t=this._pasteAsActionContext)||void 0===t?void 0:t.preferred;return!(s&&e.providedPasteEditKinds&&!this.providerMatchesPreference(e,s))&&(null===(i=e.pasteMimeTypes)||void 0===i?void 0:i.some((e=>(0,a.SN)(e,h))))}));u.length?(e.preventDefault(),e.stopImmediatePropagation(),this._pasteAsActionContext?this.showPasteAsPick(this._pasteAsActionContext.preferred,u,r,l,d):this.doPasteInline(u,r,l,d,e)):(null===(o=this._pasteAsActionContext)||void 0===o?void 0:o.preferred)&&this.showPasteAsNoEditMessage(r,this._pasteAsActionContext.preferred)}showPasteAsNoEditMessage(e,t){var i;null===(i=C.O.get(this._editor))||void 0===i||i.showMessage((0,D.NC)("pasteAsError","No paste edits for '{0}' found",t instanceof d.o?t.value:t.providerId),e[0].getStartPosition())}doPasteInline(e,t,i,s,o){const n=(0,r.PG)((async r=>{const a=this._editor;if(!a.hasModel())return;const d=a.getModel(),l=new w.Dl(a,3,void 0,r);try{if(await this.mergeInDataFromCopy(i,s,l.token),l.token.isCancellationRequested)return;const n=e.filter((e=>this.isSupportedPasteProvider(e,i)));if(!n.length||1===n.length&&n[0]instanceof y.f8)return this.applyDefaultPasteHandler(i,s,l.token,o);const r={triggerKind:v.Nq.Automatic},c=await this.getPasteEdits(n,i,d,t,r,l.token);if(l.token.isCancellationRequested)return;if(1===c.length&&c[0].provider instanceof y.f8)return this.applyDefaultPasteHandler(i,s,l.token,o);if(c.length){const e="afterPaste"===a.getOption(85).showPasteSelector;return this._postPasteWidgetManager.applyEditAndShowIfNeeded(t,{activeEditIndex:0,allEdits:c},e,(async(e,t)=>{var i,s;const o=await(null===(s=(i=e.provider).resolveDocumentPasteEdit)||void 0===s?void 0:s.call(i,e,t));return o&&(e.additionalEdit=o.additionalEdit),e}),l.token)}await this.applyDefaultPasteHandler(i,s,l.token,o)}finally{l.dispose(),this._currentPasteOperation===n&&(this._currentPasteOperation=void 0)}}));this._pasteProgressManager.showWhile(t[0].getEndPosition(),(0,D.NC)("pasteIntoEditorProgress","Running paste handlers. Click to cancel"),n),this._currentPasteOperation=n}showPasteAsPick(e,t,i,s,o){const n=(0,r.PG)((async r=>{const a=this._editor;if(!a.hasModel())return;const l=a.getModel(),c=new w.Dl(a,3,void 0,r);try{if(await this.mergeInDataFromCopy(s,o,c.token),c.token.isCancellationRequested)return;let n=t.filter((t=>this.isSupportedPasteProvider(t,s,e)));e&&(n=n.filter((t=>this.providerMatchesPreference(t,e))));const r={triggerKind:v.Nq.PasteAs,only:e&&e instanceof d.o?e:void 0};let a,h=await this.getPasteEdits(n,s,l,i,r,c.token);if(c.token.isCancellationRequested)return;if(e&&(h=h.filter((t=>e instanceof d.o?e.contains(t.kind):e.providerId===t.provider.id))),!h.length)return void(r.only&&this.showPasteAsNoEditMessage(i,r.only));if(e)a=h.at(0);else{const e=await this._quickInputService.pick(h.map((e=>{var t;return{label:e.title,description:null===(t=e.kind)||void 0===t?void 0:t.value,edit:e}})),{placeHolder:(0,D.NC)("pasteAsPickerPlaceholder","Select Paste Action")});a=null==e?void 0:e.edit}if(!a)return;const u=(0,P.n)(l.uri,i,a);await this._bulkEditService.apply(u,{editor:this._editor})}finally{c.dispose(),this._currentPasteOperation===n&&(this._currentPasteOperation=void 0)}}));this._progressService.withProgress({location:10,title:(0,D.NC)("pasteAsProgress","Running paste handlers")},(()=>n))}setCopyMetadata(e,t){e.setData(L,JSON.stringify(t))}fetchCopyMetadata(e){var t;if(!e.clipboardData)return;const i=e.clipboardData.getData(L);if(i)try{return JSON.parse(i)}catch(e){return}const[s,o]=p.b6.getTextData(e.clipboardData);return o?{defaultPastePayload:{mode:o.mode,multicursorText:null!==(t=o.multicursorText)&&void 0!==t?t:null,pasteOnNewLine:!!o.isFromEmptySelection}}:void 0}async mergeInDataFromCopy(e,t,i){var o;if((null==t?void 0:t.id)&&(null===(o=s._currentCopyOperation)||void 0===o?void 0:o.handle)===t.id){const t=await s._currentCopyOperation.dataTransferPromise;if(i.isCancellationRequested)return;for(const[i,s]of t)e.replace(i,s)}if(!e.has(c.v.uriList)){const t=await this._clipboardService.readResources();if(i.isCancellationRequested)return;t.length&&e.append(c.v.uriList,(0,a.ZO)(a.Z0.create(t)))}}async getPasteEdits(e,t,i,s,o,a){const d=await(0,r.eP)(Promise.all(e.map((async e=>{var n,r;try{const d=await(null===(n=e.provideDocumentPasteEdits)||void 0===n?void 0:n.call(e,i,s,t,o,a));return null===(r=null==d?void 0:d.edits)||void 0===r?void 0:r.map((t=>({...t,provider:e})))}catch(e){}}))),a),l=(0,n.kX)(null!=d?d:[]).flat().filter((e=>!o.only||o.only.contains(e.kind)));return(0,P.C)(l)}async applyDefaultPasteHandler(e,t,i,s){var o,n,r,a;const d=null!==(o=e.get(c.v.text))&&void 0!==o?o:e.get("text"),l=null!==(n=await(null==d?void 0:d.asString()))&&void 0!==n?n:"";if(i.isCancellationRequested)return;const h={clipboardEvent:s,text:l,pasteOnNewLine:null!==(r=null==t?void 0:t.defaultPastePayload.pasteOnNewLine)&&void 0!==r&&r,multicursorText:null!==(a=null==t?void 0:t.defaultPastePayload.multicursorText)&&void 0!==a?a:null,mode:null};this._editor.trigger("keyboard","paste",h)}isSupportedPasteProvider(e,t,i){var s;return!!(null===(s=e.pasteMimeTypes)||void 0===s?void 0:s.some((e=>t.matches(e))))&&(!i||this.providerMatchesPreference(e,i))}providerMatchesPreference(e,t){return t instanceof d.o?!e.providedPasteEditKinds||e.providedPasteEditKinds.some((e=>t.contains(e))):e.id===t.providerId}};R.ID="editor.contrib.copyPasteActionController",R=s=M([I(1,T.TG),I(2,m.vu),I(3,S.p),I(4,_.p),I(5,x.eJ),I(6,k.R9)],R)},51512:(e,t,i)=>{i.d(t,{P4:()=>C,f8:()=>_,vJ:()=>D});var s=i(9488),o=i(73278),n=i(85373),r=i(5976),a=i(81170),d=i(66663),l=i(95935),c=i(70666),h=i(71204),u=i(71922),p=i(63580),g=i(40382),m=function(e,t,i,s){var o,n=arguments.length,r=n<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,i,s);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(n<3?o(r):n>3?o(t,i,r):o(t,i))||r);return n>3&&r&&Object.defineProperty(t,i,r),r},f=function(e,t){return function(i,s){t(i,s,e)}};class v{async provideDocumentPasteEdits(e,t,i,s,o){const n=await this.getEdit(i,o);if(n)return{dispose(){},edits:[{insertText:n.insertText,title:n.title,kind:n.kind,handledMimeType:n.handledMimeType,yieldTo:n.yieldTo}]}}async provideDocumentDropEdits(e,t,i,s){const o=await this.getEdit(i,s);return o?[{insertText:o.insertText,title:o.title,kind:o.kind,handledMimeType:o.handledMimeType,yieldTo:o.yieldTo}]:void 0}}class _ extends v{constructor(){super(...arguments),this.kind=_.kind,this.dropMimeTypes=[a.v.text],this.pasteMimeTypes=[a.v.text]}async getEdit(e,t){const i=e.get(a.v.text);if(!i)return;if(e.has(a.v.uriList))return;const s=await i.asString();return{handledMimeType:a.v.text,title:(0,p.NC)("text.label","Insert Plain Text"),insertText:s,kind:this.kind}}}_.id="text",_.kind=new n.o("text.plain");class y extends v{constructor(){super(...arguments),this.kind=new n.o("uri.absolute"),this.dropMimeTypes=[a.v.uriList],this.pasteMimeTypes=[a.v.uriList]}async getEdit(e,t){const i=await b(e);if(!i.length||t.isCancellationRequested)return;let s=0;const o=i.map((({uri:e,originalText:t})=>e.scheme===d.lg.file?e.fsPath:(s++,t))).join(" ");let n;return n=s>0?i.length>1?(0,p.NC)("defaultDropProvider.uriList.uris","Insert Uris"):(0,p.NC)("defaultDropProvider.uriList.uri","Insert Uri"):i.length>1?(0,p.NC)("defaultDropProvider.uriList.paths","Insert Paths"):(0,p.NC)("defaultDropProvider.uriList.path","Insert Path"),{handledMimeType:a.v.uriList,insertText:o,title:n,kind:this.kind}}}let P=class extends v{constructor(e){super(),this._workspaceContextService=e,this.kind=new n.o("uri.relative"),this.dropMimeTypes=[a.v.uriList],this.pasteMimeTypes=[a.v.uriList]}async getEdit(e,t){const i=await b(e);if(!i.length||t.isCancellationRequested)return;const o=(0,s.kX)(i.map((({uri:e})=>{const t=this._workspaceContextService.getWorkspaceFolder(e);return t?(0,l.lX)(t.uri,e):void 0})));return o.length?{handledMimeType:a.v.uriList,insertText:o.join(" "),title:i.length>1?(0,p.NC)("defaultDropProvider.uriList.relativePaths","Insert Relative Paths"):(0,p.NC)("defaultDropProvider.uriList.relativePath","Insert Relative Path"),kind:this.kind}:void 0}};P=m([f(0,g.ec)],P);class w{constructor(){this.kind=new n.o("html"),this.pasteMimeTypes=["text/html"],this._yieldTo=[{mimeType:a.v.text}]}async provideDocumentPasteEdits(e,t,i,s,o){var n;if(s.triggerKind!==h.Nq.PasteAs&&!(null===(n=s.only)||void 0===n?void 0:n.contains(this.kind)))return;const r=i.get("text/html"),a=await(null==r?void 0:r.asString());return a&&!o.isCancellationRequested?{dispose(){},edits:[{insertText:a,yieldTo:this._yieldTo,title:(0,p.NC)("pasteHtmlLabel","Insert HTML"),kind:this.kind}]}:void 0}}async function b(e){const t=e.get(a.v.uriList);if(!t)return[];const i=await t.asString(),s=[];for(const e of o.Z0.parse(i))try{s.push({uri:c.o.parse(e),originalText:e})}catch(e){}return s}let C=class extends r.JT{constructor(e,t){super(),this._register(e.documentDropEditProvider.register("*",new _)),this._register(e.documentDropEditProvider.register("*",new y)),this._register(e.documentDropEditProvider.register("*",new P(t)))}};C=m([f(0,u.p),f(1,g.ec)],C);let D=class extends r.JT{constructor(e,t){super(),this._register(e.documentPasteEditProvider.register("*",new _)),this._register(e.documentPasteEditProvider.register("*",new y)),this._register(e.documentPasteEditProvider.register("*",new P(t))),this._register(e.documentPasteEditProvider.register("*",new w))}};D=m([f(0,u.p),f(1,g.ec)],D)},40845:(e,t,i)=>{var s,o=i(16830),n=i(800),r=i(10637),a=i(51512),d=i(63580),l=i(23193),c=i(89872),h=i(9488),u=i(15393),p=i(73278),g=i(85373),m=i(5976),f=i(92944),v=i(24314),_=i(71922),y=i(80642),P=i(58345),w=i(16467),b=i(4074),C=i(33108),D=i(93983),S=i(16021),E=i(72065),T=i(91092),k=i(50987),x=function(e,t,i,s){var o,n=arguments.length,r=n<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,i,s);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(n<3?o(r):n>3?o(t,i,r):o(t,i))||r);return n>3&&r&&Object.defineProperty(t,i,r),r},N=function(e,t){return function(i,s){t(i,s,e)}};const M="editor.experimental.dropIntoEditor.defaultProvider",I="editor.changeDropType",O=new D.uy("dropWidgetVisible",!1,(0,d.NC)("dropWidgetVisible","Whether the drop widget is showing"));let A=s=class extends m.JT{static get(e){return e.getContribution(s.ID)}constructor(e,t,i,s,o){super(),this._configService=i,this._languageFeaturesService=s,this._treeViewsDragAndDropService=o,this.treeItemsTransfer=S.Ej.getInstance(),this._dropProgressManager=this._register(t.createInstance(b.r,"dropIntoEditor",e)),this._postDropWidgetManager=this._register(t.createInstance(k.p,"dropIntoEditor",e,O,{id:I,label:(0,d.NC)("postDropWidgetTitle","Show drop options...")})),this._register(e.onDropIntoEditor((t=>this.onDropIntoEditor(e,t.position,t.event))))}clearWidgets(){this._postDropWidgetManager.clear()}changeDropType(){this._postDropWidgetManager.tryShowSelector()}async onDropIntoEditor(e,t,i){var s;if(!i.dataTransfer||!e.hasModel())return;null===(s=this._currentOperation)||void 0===s||s.cancel(),e.focus(),e.setPosition(t);const o=(0,u.PG)((async s=>{const n=new w.Dl(e,1,void 0,s);try{const o=await this.extractDataTransferData(i);if(0===o.size||n.token.isCancellationRequested)return;const r=e.getModel();if(!r)return;const a=this._languageFeaturesService.documentDropEditProvider.ordered(r).filter((e=>!e.dropMimeTypes||e.dropMimeTypes.some((e=>o.matches(e))))),d=await this.getDropEdits(a,r,t,o,n);if(n.token.isCancellationRequested)return;if(d.length){const i=this.getInitialActiveEditIndex(r,d),o="afterDrop"===e.getOption(36).showDropSelector;await this._postDropWidgetManager.applyEditAndShowIfNeeded([v.e.fromPositions(t)],{activeEditIndex:i,allEdits:d},o,(async e=>e),s)}}finally{n.dispose(),this._currentOperation===o&&(this._currentOperation=void 0)}}));this._dropProgressManager.showWhile(t,(0,d.NC)("dropIntoEditorProgress","Running drop handlers. Click to cancel"),o),this._currentOperation=o}async getDropEdits(e,t,i,s,o){const n=await(0,u.eP)(Promise.all(e.map((async e=>{try{const n=await e.provideDocumentDropEdits(t,i,s,o.token);return null==n?void 0:n.map((t=>({...t,providerId:e.id})))}catch(e){}}))),o.token),r=(0,h.kX)(null!=n?n:[]).flat();return(0,T.C)(r)}getInitialActiveEditIndex(e,t){const i=this._configService.getValue(M,{resource:e.uri});for(const[e,s]of Object.entries(i)){const i=new g.o(s),o=t.findIndex((t=>i.value===t.providerId&&t.handledMimeType&&(0,p.SN)(e,[t.handledMimeType])));if(o>=0)return o}return 0}async extractDataTransferData(e){if(!e.dataTransfer)return new p.Hl;const t=(0,f.L)(e.dataTransfer);if(this.treeItemsTransfer.hasData(y.f.prototype)){const e=this.treeItemsTransfer.getData(y.f.prototype);if(Array.isArray(e))for(const i of e){const e=await this._treeViewsDragAndDropService.removeDragOperationTransfer(i.identifier);if(e)for(const[i,s]of e)t.replace(i,s)}}return t}};A.ID="editor.contrib.dropIntoEditorController",A=s=x([N(1,E.TG),N(2,C.Ui),N(3,_.p),N(4,P.m)],A),(0,o._K)(A.ID,A,2),(0,r.y)(a.P4),(0,o.fK)(new class extends o._l{constructor(){super({id:I,precondition:O,kbOpts:{weight:100,primary:2137}})}runEditorCommand(e,t,i){var s;null===(s=A.get(t))||void 0===s||s.changeDropType()}}),(0,o.fK)(new class extends o._l{constructor(){super({id:"editor.hideDropWidget",precondition:O,kbOpts:{weight:100,primary:9}})}runEditorCommand(e,t,i){var s;null===(s=A.get(t))||void 0===s||s.clearWidgets()}}),c.B.as(l.IP.Configuration).registerConfiguration({...n.wk,properties:{[M]:{type:"object",scope:5,description:d.NC("defaultProviderDescription","Configures the default drop provider to use for content of a given mime type."),default:{},additionalProperties:{type:"string"}}}})},91092:(e,t,i)=>{i.d(t,{C:()=>r,n:()=>n});var s=i(66007),o=i(35084);function n(e,t,i){var n,r,a,d;return("string"==typeof i.insertText?""===i.insertText:""===i.insertText.snippet)?{edits:null!==(r=null===(n=i.additionalEdit)||void 0===n?void 0:n.edits)&&void 0!==r?r:[]}:{edits:[...t.map((t=>new s.Gl(e,{range:t,text:"string"==typeof i.insertText?o.Yj.escape(i.insertText)+"$0":i.insertText.snippet,insertAsSnippet:!0}))),...null!==(d=null===(a=i.additionalEdit)||void 0===a?void 0:a.edits)&&void 0!==d?d:[]]}}function r(e){var t;function i(e,t){return"mimeType"in e?e.mimeType===t.handledMimeType:!!t.kind&&e.kind.contains(t.kind)}const s=new Map;for(const o of e)for(const n of null!==(t=o.yieldTo)&&void 0!==t?t:[])for(const t of e)if(t!==o&&i(n,t)){let e=s.get(o);e||(e=[],s.set(o,e)),e.push(t)}if(!s.size)return Array.from(e);const o=new Set,n=[];return function e(t){if(!t.length)return[];const i=t[0];if(n.includes(i))return t;if(o.has(i))return e(t.slice(1));let r=[];const a=s.get(i);return a&&(n.push(i),r=e(a),n.pop()),o.add(i),[...r,i,...e(t.slice(1))]}(Array.from(e))}},50987:(e,t,i)=>{i.d(t,{p:()=>b});var s,o=i(65321),n=i(43416),r=i(74741),a=i(59523),d=i(17301),l=i(4669),c=i(5976),h=i(66007),u=i(91092),p=i(63580),g=i(93983),m=i(5606),f=i(72065),v=i(91847),_=i(59422),y=function(e,t,i,s){var o,n=arguments.length,r=n<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,i,s);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(n<3?o(r):n>3?o(t,i,r):o(t,i))||r);return n>3&&r&&Object.defineProperty(t,i,r),r},P=function(e,t){return function(i,s){t(i,s,e)}};let w=s=class extends c.JT{constructor(e,t,i,s,o,n,r,a,d,h){super(),this.typeId=e,this.editor=t,this.showCommand=s,this.range=o,this.edits=n,this.onSelectNewEdit=r,this._contextMenuService=a,this._keybindingService=h,this.allowEditorOverflow=!0,this.suppressMouseDown=!0,this.create(),this.visibleContext=i.bindTo(d),this.visibleContext.set(!0),this._register((0,c.OF)((()=>this.visibleContext.reset()))),this.editor.addContentWidget(this),this.editor.layoutContentWidget(this),this._register((0,c.OF)((()=>this.editor.removeContentWidget(this)))),this._register(this.editor.onDidChangeCursorPosition((e=>{o.containsPosition(e.position)||this.dispose()}))),this._register(l.ju.runAndSubscribe(h.onDidUpdateKeybindings,(()=>{this._updateButtonTitle()})))}_updateButtonTitle(){var e;const t=null===(e=this._keybindingService.lookupKeybinding(this.showCommand.id))||void 0===e?void 0:e.getLabel();this.button.element.title=this.showCommand.label+(t?` (${t})`:"")}create(){this.domNode=o.$(".post-edit-widget"),this.button=this._register(new n.z(this.domNode,{supportIcons:!0})),this.button.label="$(insert)",this._register(o.nm(this.domNode,o.tw.CLICK,(()=>this.showSelector())))}getId(){return s.baseId+"."+this.typeId}getDomNode(){return this.domNode}getPosition(){return{position:this.range.getEndPosition(),preference:[2]}}showSelector(){this._contextMenuService.showContextMenu({getAnchor:()=>{const e=o.i(this.button.element);return{x:e.left+e.width,y:e.top+e.height}},getActions:()=>this.edits.allEdits.map(((e,t)=>(0,r.xw)({id:"",label:e.title,checked:t===this.edits.activeEditIndex,run:()=>{if(t!==this.edits.activeEditIndex)return this.onSelectNewEdit(t)}})))})}};w.baseId="editor.widget.postEditWidget",w=s=y([P(7,m.i),P(8,g.i6),P(9,v.d)],w);let b=class extends c.JT{constructor(e,t,i,s,o,n,r){super(),this._id=e,this._editor=t,this._visibleContext=i,this._showCommand=s,this._instantiationService=o,this._bulkEditService=n,this._notificationService=r,this._currentWidget=this._register(new c.XK),this._register(l.ju.any(t.onDidChangeModel,t.onDidChangeModelContent)((()=>this.clear())))}async applyEditAndShowIfNeeded(e,t,i,s,o){const n=this._editor.getModel();if(!n||!e.length)return;const r=t.allEdits.at(t.activeEditIndex);if(!r)return;const l=async n=>{const r=this._editor.getModel();r&&(await r.undo(),this.applyEditAndShowIfNeeded(e,{activeEditIndex:n,allEdits:t.allEdits},i,s,o))},c=(s,o)=>{(0,d.n2)(s)||(this._notificationService.error(o),i&&this.show(e[0],t,l))};let h;try{h=await s(r,o)}catch(e){return c(e,(0,p.NC)("resolveError","Error resolving edit '{0}':\n{1}",r.title,(0,a.y)(e)))}if(o.isCancellationRequested)return;const g=(0,u.n)(n.uri,e,h),m=e[0],f=n.deltaDecorations([],[{range:m,options:{description:"paste-line-suffix",stickiness:0}}]);let v,_;this._editor.focus();try{v=await this._bulkEditService.apply(g,{editor:this._editor,token:o}),_=n.getDecorationRange(f[0])}catch(e){return c(e,(0,p.NC)("applyError","Error applying edit '{0}':\n{1}",r.title,(0,a.y)(e)))}finally{n.deltaDecorations(f,[])}o.isCancellationRequested||i&&v.isApplied&&t.allEdits.length>1&&this.show(null!=_?_:m,t,l)}show(e,t,i){this.clear(),this._editor.hasModel()&&(this._currentWidget.value=this._instantiationService.createInstance(w,this._id,this._editor,this._visibleContext,this._showCommand,e,t,i))}clear(){this._currentWidget.clear()}tryShowSelector(){var e;null===(e=this._currentWidget.value)||void 0===e||e.showSelector()}};b=y([P(4,f.TG),P(5,h.vu),P(6,_.lT)],b)},16467:(e,t,i)=>{i.d(t,{yy:()=>f,Dl:()=>v,YQ:()=>_});var s=i(97295),o=i(24314),n=i(71050),r=i(5976),a=i(16830),d=i(93983),l=i(91741),c=i(72065),h=i(65026),u=i(63580);const p=(0,c.yh)("IEditorCancelService"),g=new d.uy("cancellableOperation",!1,(0,u.NC)("cancellableOperation","Whether the editor runs a cancellable operation, e.g. like 'Peek References'"));(0,h.z)(p,class{constructor(){this._tokens=new WeakMap}add(e,t){let i,s=this._tokens.get(e);return s||(s=e.invokeWithinContext((e=>({key:g.bindTo(e.get(d.i6)),tokens:new l.S}))),this._tokens.set(e,s)),s.key.set(!0),i=s.tokens.push(t),()=>{i&&(i(),s.key.set(!s.tokens.isEmpty()),i=void 0)}}cancel(e){const t=this._tokens.get(e);if(!t)return;const i=t.tokens.pop();i&&(i.cancel(),t.key.set(!t.tokens.isEmpty()))}},1);class m extends n.AU{constructor(e,t){super(t),this.editor=e,this._unregister=e.invokeWithinContext((t=>t.get(p).add(e,this)))}dispose(){this._unregister(),super.dispose()}}(0,a.fK)(new class extends a._l{constructor(){super({id:"editor.cancelOperation",kbOpts:{weight:100,primary:9},precondition:g})}runEditorCommand(e,t){e.get(p).cancel(t)}});class f{constructor(e,t){if(this.flags=t,1&this.flags){const t=e.getModel();this.modelVersionId=t?s.WU("{0}#{1}",t.uri.toString(),t.getVersionId()):null}else this.modelVersionId=null;4&this.flags?this.position=e.getPosition():this.position=null,2&this.flags?this.selection=e.getSelection():this.selection=null,8&this.flags?(this.scrollLeft=e.getScrollLeft(),this.scrollTop=e.getScrollTop()):(this.scrollLeft=-1,this.scrollTop=-1)}_equals(e){if(!(e instanceof f))return!1;const t=e;return this.modelVersionId===t.modelVersionId&&(this.scrollLeft===t.scrollLeft&&this.scrollTop===t.scrollTop&&(!(!this.position&&t.position||this.position&&!t.position||this.position&&t.position&&!this.position.equals(t.position))&&!(!this.selection&&t.selection||this.selection&&!t.selection||this.selection&&t.selection&&!this.selection.equalsRange(t.selection))))}validate(e){return this._equals(new f(e,this.flags))}}class v extends m{constructor(e,t,i,s){super(e,s),this._listener=new r.SL,4&t&&this._listener.add(e.onDidChangeCursorPosition((e=>{i&&o.e.containsPosition(i,e.position)||this.cancel()}))),2&t&&this._listener.add(e.onDidChangeCursorSelection((e=>{i&&o.e.containsRange(i,e.selection)||this.cancel()}))),8&t&&this._listener.add(e.onDidScrollChange((e=>this.cancel()))),1&t&&(this._listener.add(e.onDidChangeModel((e=>this.cancel()))),this._listener.add(e.onDidChangeModelContent((e=>this.cancel()))))}dispose(){this._listener.dispose(),super.dispose()}}class _ extends n.AU{constructor(e,t){super(t),this._listener=e.onDidChangeContent((()=>this.cancel()))}dispose(){this._listener.dispose(),super.dispose()}}}}]);