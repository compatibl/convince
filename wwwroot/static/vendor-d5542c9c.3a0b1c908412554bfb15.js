"use strict";(self.webpackChunkui_react=self.webpackChunkui_react||[]).push([[9958],{18352:(e,t,s)=>{s.d(t,{HZ:()=>c,PB:()=>v});var n=s(17301),r=s(4669),i=s(5976),h=s(36248),o=s(1432),a=s(97295);const d="$initialize";let l=!1;function c(e){o.$L&&(l||(l=!0))}class g{constructor(e,t,s,n){this.vsWorker=e,this.req=t,this.method=s,this.args=n,this.type=0}}class u{constructor(e,t,s,n){this.vsWorker=e,this.seq=t,this.res=s,this.err=n,this.type=1}}class _{constructor(e,t,s,n){this.vsWorker=e,this.req=t,this.eventName=s,this.arg=n,this.type=2}}class p{constructor(e,t,s){this.vsWorker=e,this.req=t,this.event=s,this.type=3}}class f{constructor(e,t){this.vsWorker=e,this.req=t,this.type=4}}class E{constructor(e){this._workerId=-1,this._handler=e,this._lastSentReq=0,this._pendingReplies=Object.create(null),this._pendingEmitters=new Map,this._pendingEvents=new Map}setWorkerId(e){this._workerId=e}sendMessage(e,t){const s=String(++this._lastSentReq);return new Promise(((n,r)=>{this._pendingReplies[s]={resolve:n,reject:r},this._send(new g(this._workerId,s,e,t))}))}listen(e,t){let s=null;const n=new r.Q5({onWillAddFirstListener:()=>{s=String(++this._lastSentReq),this._pendingEmitters.set(s,n),this._send(new _(this._workerId,s,e,t))},onDidRemoveLastListener:()=>{this._pendingEmitters.delete(s),this._send(new f(this._workerId,s)),s=null}});return n.event}handleMessage(e){e&&e.vsWorker&&(-1!==this._workerId&&e.vsWorker!==this._workerId||this._handleMessage(e))}_handleMessage(e){switch(e.type){case 1:return this._handleReplyMessage(e);case 0:return this._handleRequestMessage(e);case 2:return this._handleSubscribeEventMessage(e);case 3:return this._handleEventMessage(e);case 4:return this._handleUnsubscribeEventMessage(e)}}_handleReplyMessage(e){if(!this._pendingReplies[e.seq])return;const t=this._pendingReplies[e.seq];if(delete this._pendingReplies[e.seq],e.err){let s=e.err;return e.err.$isError&&(s=new Error,s.name=e.err.name,s.message=e.err.message,s.stack=e.err.stack),void t.reject(s)}t.resolve(e.res)}_handleRequestMessage(e){const t=e.req;this._handler.handleMessage(e.method,e.args).then((e=>{this._send(new u(this._workerId,t,e,void 0))}),(e=>{e.detail instanceof Error&&(e.detail=(0,n.ri)(e.detail)),this._send(new u(this._workerId,t,void 0,(0,n.ri)(e)))}))}_handleSubscribeEventMessage(e){const t=e.req,s=this._handler.handleEvent(e.eventName,e.arg)((e=>{this._send(new p(this._workerId,t,e))}));this._pendingEvents.set(t,s)}_handleEventMessage(e){this._pendingEmitters.has(e.req)&&this._pendingEmitters.get(e.req).fire(e.event)}_handleUnsubscribeEventMessage(e){this._pendingEvents.has(e.req)&&(this._pendingEvents.get(e.req).dispose(),this._pendingEvents.delete(e.req))}_send(e){const t=[];if(0===e.type)for(let s=0;s<e.args.length;s++)e.args[s]instanceof ArrayBuffer&&t.push(e.args[s]);else 1===e.type&&e.res instanceof ArrayBuffer&&t.push(e.res);this._handler.sendMessage(e,t)}}class v extends i.JT{constructor(e,t,s){super();let n=null;this._worker=this._register(e.create("vs/base/common/worker/simpleWorker",(e=>{this._protocol.handleMessage(e)}),(e=>{null==n||n(e)}))),this._protocol=new E({sendMessage:(e,t)=>{this._worker.postMessage(e,t)},handleMessage:(e,t)=>{if("function"!=typeof s[e])return Promise.reject(new Error("Missing method "+e+" on main thread host."));try{return Promise.resolve(s[e].apply(s,t))}catch(e){return Promise.reject(e)}},handleEvent:(e,t)=>{if(m(e)){const n=s[e].call(s,t);if("function"!=typeof n)throw new Error(`Missing dynamic event ${e} on main thread host.`);return n}if(w(e)){const t=s[e];if("function"!=typeof t)throw new Error(`Missing event ${e} on main thread host.`);return t}throw new Error(`Malformed event name ${e}`)}}),this._protocol.setWorkerId(this._worker.getId());let r=null;const i=globalThis.require;void 0!==i&&"function"==typeof i.getConfig?r=i.getConfig():void 0!==globalThis.requirejs&&(r=globalThis.requirejs.s.contexts._.config);const o=(0,h.$E)(s);this._onModuleLoaded=this._protocol.sendMessage(d,[this._worker.getId(),JSON.parse(JSON.stringify(r)),t,o]);const a=(e,t)=>this._request(e,t),l=(e,t)=>this._protocol.listen(e,t);this._lazyProxy=new Promise(((e,s)=>{n=s,this._onModuleLoaded.then((t=>{e(y(t,a,l))}),(e=>{s(e),this._onError("Worker failed to load "+t,e)}))}))}getProxyObject(){return this._lazyProxy}_request(e,t){return new Promise(((s,n)=>{this._onModuleLoaded.then((()=>{this._protocol.sendMessage(e,t).then(s,n)}),n)}))}_onError(e,t){}}function w(e){return"o"===e[0]&&"n"===e[1]&&a.df(e.charCodeAt(2))}function m(e){return/^onDynamic/.test(e)&&a.df(e.charCodeAt(9))}function y(e,t,s){const n=e=>function(){const s=Array.prototype.slice.call(arguments,0);return t(e,s)},r=e=>function(t){return s(e,t)},i={};for(const t of e)m(t)?i[t]=r(t):w(t)?i[t]=s(t,void 0):i[t]=n(t);return i}},10748:(e,t,s)=>{s.d(t,{KV:()=>n,Ke:()=>l,Wm:()=>c});var n,r,i=s(15393),h=s(4669),o=s(5976),a=s(23897),d=s(98401);!function(e){e[e.STORAGE_DOES_NOT_EXIST=0]="STORAGE_DOES_NOT_EXIST",e[e.STORAGE_IN_MEMORY=1]="STORAGE_IN_MEMORY"}(n||(n={})),function(e){e[e.None=0]="None",e[e.Initialized=1]="Initialized",e[e.Closed=2]="Closed"}(r||(r={}));class l extends o.JT{constructor(e,t=Object.create(null)){super(),this.database=e,this.options=t,this._onDidChangeStorage=this._register(new h.K3),this.onDidChangeStorage=this._onDidChangeStorage.event,this.state=r.None,this.cache=new Map,this.flushDelayer=this._register(new i.rH(l.DEFAULT_FLUSH_DELAY)),this.pendingDeletes=new Set,this.pendingInserts=new Map,this.whenFlushedCallbacks=[],this.registerListeners()}registerListeners(){this._register(this.database.onDidChangeItemsExternal((e=>this.onDidChangeItemsExternal(e))))}onDidChangeItemsExternal(e){var t,s;this._onDidChangeStorage.pause();try{null===(t=e.changed)||void 0===t||t.forEach(((e,t)=>this.acceptExternal(t,e))),null===(s=e.deleted)||void 0===s||s.forEach((e=>this.acceptExternal(e,void 0)))}finally{this._onDidChangeStorage.resume()}}acceptExternal(e,t){if(this.state===r.Closed)return;let s=!1;if((0,d.Jp)(t))s=this.cache.delete(e);else{this.cache.get(e)!==t&&(this.cache.set(e,t),s=!0)}s&&this._onDidChangeStorage.fire({key:e,external:!0})}get(e,t){const s=this.cache.get(e);return(0,d.Jp)(s)?t:s}getBoolean(e,t){const s=this.get(e);return(0,d.Jp)(s)?t:"true"===s}getNumber(e,t){const s=this.get(e);return(0,d.Jp)(s)?t:parseInt(s,10)}async set(e,t,s=!1){if(this.state===r.Closed)return;if((0,d.Jp)(t))return this.delete(e,s);const n=(0,d.Kn)(t)||Array.isArray(t)?(0,a.Pz)(t):String(t);return this.cache.get(e)!==n?(this.cache.set(e,n),this.pendingInserts.set(e,n),this.pendingDeletes.delete(e),this._onDidChangeStorage.fire({key:e,external:s}),this.doFlush()):void 0}async delete(e,t=!1){if(this.state===r.Closed)return;return this.cache.delete(e)?(this.pendingDeletes.has(e)||this.pendingDeletes.add(e),this.pendingInserts.delete(e),this._onDidChangeStorage.fire({key:e,external:t}),this.doFlush()):void 0}get hasPending(){return this.pendingInserts.size>0||this.pendingDeletes.size>0}async flushPending(){if(!this.hasPending)return;const e={insert:this.pendingInserts,delete:this.pendingDeletes};return this.pendingDeletes=new Set,this.pendingInserts=new Map,this.database.updateItems(e).finally((()=>{var e;if(!this.hasPending)for(;this.whenFlushedCallbacks.length;)null===(e=this.whenFlushedCallbacks.pop())||void 0===e||e()}))}async doFlush(e){return this.options.hint===n.STORAGE_IN_MEMORY?this.flushPending():this.flushDelayer.trigger((()=>this.flushPending()),e)}}l.DEFAULT_FLUSH_DELAY=100;class c{constructor(){this.onDidChangeItemsExternal=h.ju.None,this.items=new Map}async updateItems(e){var t,s;null===(t=e.insert)||void 0===t||t.forEach(((e,t)=>this.items.set(t,e))),null===(s=e.delete)||void 0===s||s.forEach((e=>this.items.delete(e)))}}}}]);