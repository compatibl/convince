"use strict";(self.webpackChunkui_react=self.webpackChunkui_react||[]).push([[6374],{1812:(e,t,i)=>{i.d(t,{i:()=>u});var s=i(65321),o=i(21661),n=i(97759),r=i(43799),l=i(23937),d=i(4669),a=i(5976);class h{constructor(e,t,i){this.columns=e,this.getColumnSize=i,this.templateId=h.TemplateId,this.renderedTemplates=new Set;const s=new Map(t.map((e=>[e.templateId,e])));this.renderers=[];for(const t of e){const e=s.get(t.templateId);if(!e)throw new Error(`Table cell renderer for template id ${t.templateId} not found.`);this.renderers.push(e)}}renderTemplate(e){const t=(0,s.R3)(e,(0,s.$)(".monaco-table-tr")),i=[],o=[];for(let e=0;e<this.columns.length;e++){const n=this.renderers[e],r=(0,s.R3)(t,(0,s.$)(".monaco-table-td",{"data-col-index":e}));r.style.width=`${this.getColumnSize(e)}px`,i.push(r),o.push(n.renderTemplate(r))}const n={container:e,cellContainers:i,cellTemplateData:o};return this.renderedTemplates.add(n),n}renderElement(e,t,i,s){for(let o=0;o<this.columns.length;o++){const n=this.columns[o].project(e);this.renderers[o].renderElement(n,t,i.cellTemplateData[o],s)}}disposeElement(e,t,i,s){for(let o=0;o<this.columns.length;o++){const n=this.renderers[o];if(n.disposeElement){const r=this.columns[o].project(e);n.disposeElement(r,t,i.cellTemplateData[o],s)}}}disposeTemplate(e){for(let t=0;t<this.columns.length;t++){this.renderers[t].disposeTemplate(e.cellTemplateData[t])}(0,s.PO)(e.container),this.renderedTemplates.delete(e)}layoutColumn(e,t){for(const{cellContainers:i}of this.renderedTemplates)i[e].style.width=`${t}px`}}h.TemplateId="row";class c extends a.JT{get minimumSize(){var e;return null!==(e=this.column.minimumWidth)&&void 0!==e?e:120}get maximumSize(){var e;return null!==(e=this.column.maximumWidth)&&void 0!==e?e:Number.POSITIVE_INFINITY}get onDidChange(){var e;return null!==(e=this.column.onDidChangeWidthConstraints)&&void 0!==e?e:d.ju.None}constructor(e,t){super(),this.column=e,this.index=t,this._onDidLayout=new d.Q5,this.onDidLayout=this._onDidLayout.event,this.element=(0,s.$)(".monaco-table-th",{"data-col-index":t},e.label),e.tooltip&&this._register((0,o.B)().setupUpdatableHover((0,n.tM)("mouse"),this.element,e.tooltip))}layout(e){this._onDidLayout.fire([this.index,e])}}class u{get onDidChangeFocus(){return this.list.onDidChangeFocus}get onDidChangeSelection(){return this.list.onDidChangeSelection}get onDidScroll(){return this.list.onDidScroll}get onMouseDblClick(){return this.list.onMouseDblClick}get onPointer(){return this.list.onPointer}get onDidFocus(){return this.list.onDidFocus}get scrollTop(){return this.list.scrollTop}set scrollTop(e){this.list.scrollTop=e}get scrollHeight(){return this.list.scrollHeight}get renderHeight(){return this.list.renderHeight}get onDidDispose(){return this.list.onDidDispose}constructor(e,t,i,o,n,p){this.virtualDelegate=i,this.domId="table_id_"+ ++u.InstanceCount,this.disposables=new a.SL,this.cachedWidth=0,this.cachedHeight=0,this.domNode=(0,s.R3)(t,(0,s.$)(`.monaco-table.${this.domId}`));const g=o.map(((e,t)=>this.disposables.add(new c(e,t)))),m={size:g.reduce(((e,t)=>e+t.column.weight),0),views:g.map((e=>({size:e.column.weight,view:e})))};this.splitview=this.disposables.add(new l.z(this.domNode,{orientation:1,scrollbarVisibility:2,getSashOrthogonalSize:()=>this.cachedHeight,descriptor:m})),this.splitview.el.style.height=`${i.headerRowHeight}px`,this.splitview.el.style.lineHeight=`${i.headerRowHeight}px`;const v=new h(o,n,(e=>this.splitview.getViewSize(e)));var f;this.list=this.disposables.add(new r.aV(e,this.domNode,(f=i,{getHeight:e=>f.getHeight(e),getTemplateId:()=>h.TemplateId}),[v],p)),d.ju.any(...g.map((e=>e.onDidLayout)))((([e,t])=>v.layoutColumn(e,t)),null,this.disposables),this.splitview.onDidSashReset((e=>{const t=o.reduce(((e,t)=>e+t.weight),0),i=o[e].weight/t*this.cachedWidth;this.splitview.resizeView(e,i)}),null,this.disposables),this.styleElement=(0,s.dS)(this.domNode),this.style(r.uZ)}updateOptions(e){this.list.updateOptions(e)}splice(e,t,i=[]){this.list.splice(e,t,i)}getHTMLElement(){return this.domNode}style(e){const t=[];t.push(`.monaco-table.${this.domId} > .monaco-split-view2 .monaco-sash.vertical::before {\n\t\t\ttop: ${this.virtualDelegate.headerRowHeight+1}px;\n\t\t\theight: calc(100% - ${this.virtualDelegate.headerRowHeight}px);\n\t\t}`),this.styleElement.textContent=t.join("\n"),this.list.style(e)}getSelectedElements(){return this.list.getSelectedElements()}getSelection(){return this.list.getSelection()}getFocus(){return this.list.getFocus()}dispose(){this.disposables.dispose()}}u.InstanceCount=0},82900:(e,t,i)=>{i.d(t,{D:()=>d,Z:()=>a});var s=i(93794),o=i(25670),n=i(4669),r=i(97759),l=i(21661);const d={inputActiveOptionBorder:"#007ACC00",inputActiveOptionForeground:"#FFFFFF",inputActiveOptionBackground:"#0E639C50"};class a extends s.${constructor(e){var t;super(),this._onChange=this._register(new n.Q5),this.onChange=this._onChange.event,this._onKeyDown=this._register(new n.Q5),this.onKeyDown=this._onKeyDown.event,this._opts=e,this._checked=this._opts.isChecked;const i=["monaco-custom-toggle"];this._opts.icon&&(this._icon=this._opts.icon,i.push(...o.k.asClassNameArray(this._icon))),this._opts.actionClassName&&i.push(...this._opts.actionClassName.split(" ")),this._checked&&i.push("checked"),this.domNode=document.createElement("div"),this._hover=this._register((0,l.B)().setupUpdatableHover(null!==(t=e.hoverDelegate)&&void 0!==t?t:(0,r.tM)("mouse"),this.domNode,this._opts.title)),this.domNode.classList.add(...i),this._opts.notFocusable||(this.domNode.tabIndex=0),this.domNode.setAttribute("role","checkbox"),this.domNode.setAttribute("aria-checked",String(this._checked)),this.domNode.setAttribute("aria-label",this._opts.title),this.applyStyles(),this.onclick(this.domNode,(e=>{this.enabled&&(this.checked=!this._checked,this._onChange.fire(!1),e.preventDefault())})),this._register(this.ignoreGesture(this.domNode)),this.onkeydown(this.domNode,(e=>{if(10===e.keyCode||3===e.keyCode)return this.checked=!this._checked,this._onChange.fire(!0),e.preventDefault(),void e.stopPropagation();this._onKeyDown.fire(e)}))}get enabled(){return"true"!==this.domNode.getAttribute("aria-disabled")}focus(){this.domNode.focus()}get checked(){return this._checked}set checked(e){this._checked=e,this.domNode.setAttribute("aria-checked",String(this._checked)),this.domNode.classList.toggle("checked",this._checked),this.applyStyles()}width(){return 22}applyStyles(){this.domNode&&(this.domNode.style.borderColor=this._checked&&this._opts.inputActiveOptionBorder||"",this.domNode.style.color=this._checked&&this._opts.inputActiveOptionForeground||"inherit",this.domNode.style.backgroundColor=this._checked&&this._opts.inputActiveOptionBackground||"")}enable(){this.domNode.setAttribute("aria-disabled",String(!1))}disable(){this.domNode.setAttribute("aria-disabled",String(!0))}}},72660:(e,t,i)=>{i.d(t,{W:()=>p,u:()=>u});var s=i(90317),o=i(61364),n=i(74741),r=i(32429),l=i(25670),d=i(4669),a=i(5976),h=i(63580),c=i(97759);class u extends a.JT{constructor(e,t,i={orientation:0}){var h;super(),this.submenuActionViewItems=[],this.hasSecondaryActions=!1,this._onDidChangeDropdownVisibility=this._register(new d.z5),this.onDidChangeDropdownVisibility=this._onDidChangeDropdownVisibility.event,this.disposables=this._register(new a.SL),i.hoverDelegate=null!==(h=i.hoverDelegate)&&void 0!==h?h:this._register((0,c.p0)()),this.options=i,this.lookupKeybindings="function"==typeof this.options.getKeyBinding,this.toggleMenuAction=this._register(new p((()=>{var e;return null===(e=this.toggleMenuActionViewItem)||void 0===e?void 0:e.show()}),i.toggleMenuTitle)),this.element=document.createElement("div"),this.element.className="monaco-toolbar",e.appendChild(this.element),this.actionBar=this._register(new s.o(this.element,{orientation:i.orientation,ariaLabel:i.ariaLabel,actionRunner:i.actionRunner,allowContextMenu:i.allowContextMenu,highlightToggledItems:i.highlightToggledItems,hoverDelegate:i.hoverDelegate,actionViewItemProvider:(e,s)=>{var d;if(e.id===p.ID)return this.toggleMenuActionViewItem=new o.C(e,e.menuActions,t,{actionViewItemProvider:this.options.actionViewItemProvider,actionRunner:this.actionRunner,keybindingProvider:this.options.getKeyBinding,classNames:l.k.asClassNameArray(null!==(d=i.moreIcon)&&void 0!==d?d:r.l.toolBarMore),anchorAlignmentProvider:this.options.anchorAlignmentProvider,menuAsChild:!!this.options.renderDropdownAsChildElement,skipTelemetry:this.options.skipTelemetry,isMenu:!0,hoverDelegate:this.options.hoverDelegate}),this.toggleMenuActionViewItem.setActionContext(this.actionBar.context),this.disposables.add(this._onDidChangeDropdownVisibility.add(this.toggleMenuActionViewItem.onDidChangeVisibility)),this.toggleMenuActionViewItem;if(i.actionViewItemProvider){const t=i.actionViewItemProvider(e,s);if(t)return t}if(e instanceof n.wY){const i=new o.C(e,e.actions,t,{actionViewItemProvider:this.options.actionViewItemProvider,actionRunner:this.actionRunner,keybindingProvider:this.options.getKeyBinding,classNames:e.class,anchorAlignmentProvider:this.options.anchorAlignmentProvider,menuAsChild:!!this.options.renderDropdownAsChildElement,skipTelemetry:this.options.skipTelemetry,hoverDelegate:this.options.hoverDelegate});return i.setActionContext(this.actionBar.context),this.submenuActionViewItems.push(i),this.disposables.add(this._onDidChangeDropdownVisibility.add(i.onDidChangeVisibility)),i}}}))}set actionRunner(e){this.actionBar.actionRunner=e}get actionRunner(){return this.actionBar.actionRunner}getElement(){return this.element}getItemAction(e){return this.actionBar.getAction(e)}setActions(e,t){this.clear();const i=e?e.slice(0):[];this.hasSecondaryActions=!!(t&&t.length>0),this.hasSecondaryActions&&t&&(this.toggleMenuAction.menuActions=t.slice(0),i.push(this.toggleMenuAction)),i.forEach((e=>{this.actionBar.push(e,{icon:!0,label:!1,keybinding:this.getKeybindingLabel(e)})}))}getKeybindingLabel(e){var t,i,s;const o=this.lookupKeybindings?null===(i=(t=this.options).getKeyBinding)||void 0===i?void 0:i.call(t,e):void 0;return null!==(s=null==o?void 0:o.getLabel())&&void 0!==s?s:void 0}clear(){this.submenuActionViewItems=[],this.disposables.clear(),this.actionBar.clear()}dispose(){this.clear(),this.disposables.dispose(),super.dispose()}}class p extends n.aU{constructor(e,t){t=t||h.NC("moreActions","More Actions..."),super(p.ID,t,void 0,!0),this._menuActions=[],this.toggleDropdownMenu=e}async run(){this.toggleDropdownMenu()}get menuActions(){return this._menuActions}set menuActions(e){this._menuActions=e}}p.ID="toolbar.toggle.more"},5637:(e,t,i)=>{i.d(t,{CH:()=>U,E4:()=>s,Zd:()=>F,cz:()=>x,sZ:()=>T});var s,o=i(65321),n=(i(4850),i(36513)),r=(i(90317),i(3070),i(40114)),l=i(25707),d=i(43799),a=i(82900),h=i(71782),c=i(60350),u=(i(74741),i(9488)),p=i(15393),g=i(32429),m=i(25670),v=i(43702),f=i(4669),C=i(75392),b=i(5976),w=i(59870),y=i(98401),S=i(63580),D=(i(97759),i(21070));class N extends l.kX{constructor(e){super(e.elements.map((e=>e.element))),this.data=e}}function E(e){return e instanceof l.kX?new N(e):e}class k{constructor(e,t){this.modelProvider=e,this.dnd=t,this.autoExpandDisposable=b.JT.None,this.disposables=new b.SL}getDragURI(e){return this.dnd.getDragURI(e.element)}getDragLabel(e,t){if(this.dnd.getDragLabel)return this.dnd.getDragLabel(e.map((e=>e.element)),t)}onDragStart(e,t){var i,s;null===(s=(i=this.dnd).onDragStart)||void 0===s||s.call(i,E(e),t)}onDragOver(e,t,i,s,o,n=!0){const r=this.dnd.onDragOver(E(e),t&&t.element,i,s,o),l=this.autoExpandNode!==t;if(l&&(this.autoExpandDisposable.dispose(),this.autoExpandNode=t),void 0===t)return r;if(l&&"boolean"!=typeof r&&r.autoExpand&&(this.autoExpandDisposable=(0,p.Vg)((()=>{const e=this.modelProvider(),i=e.getNodeLocation(t);e.isCollapsed(i)&&e.setCollapsed(i,!1),this.autoExpandNode=void 0}),500,this.disposables)),"boolean"==typeof r||!r.accept||void 0===r.bubble||r.feedback){if(!n){return{accept:"boolean"==typeof r?r:r.accept,effect:"boolean"==typeof r?void 0:r.effect,feedback:[i]}}return r}if(1===r.bubble){const i=this.modelProvider(),n=i.getNodeLocation(t),r=i.getParentNodeLocation(n),l=i.getNode(r),d=r&&i.getListIndex(r);return this.onDragOver(e,l,d,s,o,!1)}const d=this.modelProvider(),a=d.getNodeLocation(t),h=d.getListIndex(a),c=d.getListRenderCount(a);return{...r,feedback:(0,u.w6)(h,h+c)}}drop(e,t,i,s,o){this.autoExpandDisposable.dispose(),this.autoExpandNode=void 0,this.dnd.drop(E(e),t&&t.element,i,s,o)}onDragEnd(e){var t,i;null===(i=(t=this.dnd).onDragEnd)||void 0===i||i.call(t,e)}dispose(){this.disposables.dispose(),this.dnd.dispose()}}class x{constructor(e){this.delegate=e}getHeight(e){return this.delegate.getHeight(e.element)}getTemplateId(e){return this.delegate.getTemplateId(e.element)}hasDynamicHeight(e){return!!this.delegate.hasDynamicHeight&&this.delegate.hasDynamicHeight(e.element)}setDynamicHeight(e,t){var i,s;null===(s=(i=this.delegate).setDynamicHeight)||void 0===s||s.call(i,e.element,t)}}!function(e){e.None="none",e.OnHover="onHover",e.Always="always"}(s||(s={}));class P{get elements(){return this._elements}constructor(e,t=[]){this._elements=t,this.disposables=new b.SL,this.onDidChange=f.ju.forEach(e,(e=>this._elements=e),this.disposables)}dispose(){this.disposables.dispose()}}class _{constructor(e,t,i,s,o,n={}){var r;this.renderer=e,this.modelProvider=t,this.activeNodes=s,this.renderedIndentGuides=o,this.renderedElements=new Map,this.renderedNodes=new Map,this.indent=_.DefaultIndent,this.hideTwistiesOfChildlessElements=!1,this.shouldRenderIndentGuides=!1,this.activeIndentNodes=new Set,this.indentGuidesDisposable=b.JT.None,this.disposables=new b.SL,this.templateId=e.templateId,this.updateOptions(n),f.ju.map(i,(e=>e.node))(this.onDidChangeNodeTwistieState,this,this.disposables),null===(r=e.onDidChangeTwistieState)||void 0===r||r.call(e,this.onDidChangeTwistieState,this,this.disposables)}updateOptions(e={}){if(void 0!==e.indent){const t=(0,w.uZ)(e.indent,0,40);if(t!==this.indent){this.indent=t;for(const[e,t]of this.renderedNodes)this.renderTreeElement(e,t)}}if(void 0!==e.renderIndentGuides){const t=e.renderIndentGuides!==s.None;if(t!==this.shouldRenderIndentGuides){this.shouldRenderIndentGuides=t;for(const[e,t]of this.renderedNodes)this._renderIndentGuides(e,t);if(this.indentGuidesDisposable.dispose(),t){const e=new b.SL;this.activeNodes.onDidChange(this._onDidChangeActiveNodes,this,e),this.indentGuidesDisposable=e,this._onDidChangeActiveNodes(this.activeNodes.elements)}}}void 0!==e.hideTwistiesOfChildlessElements&&(this.hideTwistiesOfChildlessElements=e.hideTwistiesOfChildlessElements)}renderTemplate(e){const t=(0,o.R3)(e,(0,o.$)(".monaco-tl-row")),i=(0,o.R3)(t,(0,o.$)(".monaco-tl-indent")),s=(0,o.R3)(t,(0,o.$)(".monaco-tl-twistie")),n=(0,o.R3)(t,(0,o.$)(".monaco-tl-contents")),r=this.renderer.renderTemplate(n);return{container:e,indent:i,twistie:s,indentGuidesDisposable:b.JT.None,templateData:r}}renderElement(e,t,i,s){this.renderedNodes.set(e,i),this.renderedElements.set(e.element,e),this.renderTreeElement(e,i),this.renderer.renderElement(e,t,i.templateData,s)}disposeElement(e,t,i,s){var o,n;i.indentGuidesDisposable.dispose(),null===(n=(o=this.renderer).disposeElement)||void 0===n||n.call(o,e,t,i.templateData,s),"number"==typeof s&&(this.renderedNodes.delete(e),this.renderedElements.delete(e.element))}disposeTemplate(e){this.renderer.disposeTemplate(e.templateData)}onDidChangeTwistieState(e){const t=this.renderedElements.get(e);t&&this.onDidChangeNodeTwistieState(t)}onDidChangeNodeTwistieState(e){const t=this.renderedNodes.get(e);t&&(this._onDidChangeActiveNodes(this.activeNodes.elements),this.renderTreeElement(e,t))}renderTreeElement(e,t){const i=_.DefaultIndent+(e.depth-1)*this.indent;t.twistie.style.paddingLeft=`${i}px`,t.indent.style.width=i+this.indent-16+"px",e.collapsible?t.container.setAttribute("aria-expanded",String(!e.collapsed)):t.container.removeAttribute("aria-expanded"),t.twistie.classList.remove(...m.k.asClassNameArray(g.l.treeItemExpanded));let s=!1;this.renderer.renderTwistie&&(s=this.renderer.renderTwistie(e.element,t.twistie)),e.collapsible&&(!this.hideTwistiesOfChildlessElements||e.visibleChildrenCount>0)?(s||t.twistie.classList.add(...m.k.asClassNameArray(g.l.treeItemExpanded)),t.twistie.classList.add("collapsible"),t.twistie.classList.toggle("collapsed",e.collapsed)):t.twistie.classList.remove("collapsible","collapsed"),this._renderIndentGuides(e,t)}_renderIndentGuides(e,t){if((0,o.PO)(t.indent),t.indentGuidesDisposable.dispose(),!this.shouldRenderIndentGuides)return;const i=new b.SL,s=this.modelProvider();for(;;){const n=s.getNodeLocation(e),r=s.getParentNodeLocation(n);if(!r)break;const l=s.getNode(r),d=(0,o.$)(".indent-guide",{style:`width: ${this.indent}px`});this.activeIndentNodes.has(l)&&d.classList.add("active"),0===t.indent.childElementCount?t.indent.appendChild(d):t.indent.insertBefore(d,t.indent.firstElementChild),this.renderedIndentGuides.add(l,d),i.add((0,b.OF)((()=>this.renderedIndentGuides.delete(l,d)))),e=l}t.indentGuidesDisposable=i}_onDidChangeActiveNodes(e){if(!this.shouldRenderIndentGuides)return;const t=new Set,i=this.modelProvider();e.forEach((e=>{const s=i.getNodeLocation(e);try{const o=i.getParentNodeLocation(s);e.collapsible&&e.children.length>0&&!e.collapsed?t.add(e):o&&t.add(i.getNode(o))}catch(e){}})),this.activeIndentNodes.forEach((e=>{t.has(e)||this.renderedIndentGuides.forEach(e,(e=>e.classList.remove("active")))})),t.forEach((e=>{this.activeIndentNodes.has(e)||this.renderedIndentGuides.forEach(e,(e=>e.classList.add("active")))})),this.activeIndentNodes=t}dispose(){this.renderedNodes.clear(),this.renderedElements.clear(),this.indentGuidesDisposable.dispose(),(0,b.B9)(this.disposables)}}_.DefaultIndent=8;class I{get totalCount(){return this._totalCount}get matchCount(){return this._matchCount}constructor(e,t,i){this.tree=e,this.keyboardNavigationLabelProvider=t,this._filter=i,this._totalCount=0,this._matchCount=0,this._pattern="",this._lowercasePattern="",this.disposables=new b.SL,e.onWillRefilter(this.reset,this,this.disposables)}filter(e,t){let i=1;if(this._filter){const s=this._filter.filter(e,t);if(i="boolean"==typeof s?s?1:0:(0,h.gB)(s)?(0,h.aG)(s.visibility):s,0===i)return!1}if(this._totalCount++,!this._pattern)return this._matchCount++,{data:C.CL.Default,visibility:i};const s=this.keyboardNavigationLabelProvider.getKeyboardNavigationLabel(e),o=Array.isArray(s)?s:[s];for(const e of o){const t=e&&e.toString();if(void 0===t)return{data:C.CL.Default,visibility:i};let s;if(this.tree.findMatchType===F.Contiguous){const e=t.toLowerCase().indexOf(this._lowercasePattern);if(e>-1){s=[Number.MAX_SAFE_INTEGER,0];for(let t=this._lowercasePattern.length;t>0;t--)s.push(e+t-1)}}else s=(0,C.EW)(this._pattern,this._lowercasePattern,0,t,t.toLowerCase(),0,{firstMatchCanBeWeak:!0,boostFullMatch:!0});if(s)return this._matchCount++,1===o.length?{data:s,visibility:i}:{data:{label:t,score:s},visibility:i}}return this.tree.findMode===T.Filter?"number"==typeof this.tree.options.defaultFindVisibility?this.tree.options.defaultFindVisibility:this.tree.options.defaultFindVisibility?this.tree.options.defaultFindVisibility(e):2:{data:C.CL.Default,visibility:i}}reset(){this._totalCount=0,this._matchCount=0}dispose(){(0,b.B9)(this.disposables)}}r.g4,a.D;var T,F;!function(e){e[e.Highlight=0]="Highlight",e[e.Filter=1]="Filter"}(T||(T={})),function(e){e[e.Fuzzy=0]="Fuzzy",e[e.Contiguous=1]="Contiguous"}(F||(F={}));class L{get pattern(){return this._pattern}get mode(){return this._mode}set mode(e){e!==this._mode&&(this._mode=e,this.widget&&(this.widget.mode=this._mode),this.tree.refilter(),this.render(),this._onDidChangeMode.fire(e))}get matchType(){return this._matchType}set matchType(e){e!==this._matchType&&(this._matchType=e,this.widget&&(this.widget.matchType=this._matchType),this.tree.refilter(),this.render(),this._onDidChangeMatchType.fire(e))}constructor(e,t,i,s,o,n={}){var r,l;this.tree=e,this.view=i,this.filter=s,this.contextViewProvider=o,this.options=n,this._pattern="",this.width=0,this._onDidChangeMode=new f.Q5,this.onDidChangeMode=this._onDidChangeMode.event,this._onDidChangeMatchType=new f.Q5,this.onDidChangeMatchType=this._onDidChangeMatchType.event,this._onDidChangePattern=new f.Q5,this._onDidChangeOpenState=new f.Q5,this.onDidChangeOpenState=this._onDidChangeOpenState.event,this.enabledDisposables=new b.SL,this.disposables=new b.SL,this._mode=null!==(r=e.options.defaultFindMode)&&void 0!==r?r:T.Highlight,this._matchType=null!==(l=e.options.defaultFindMatchType)&&void 0!==l?l:F.Fuzzy,t.onDidSplice(this.onDidSpliceModel,this,this.disposables)}updateOptions(e={}){void 0!==e.defaultFindMode&&(this.mode=e.defaultFindMode),void 0!==e.defaultFindMatchType&&(this.matchType=e.defaultFindMatchType)}onDidSpliceModel(){this.widget&&0!==this.pattern.length&&(this.tree.refilter(),this.render())}render(){var e,t,i,s;const o=this.filter.totalCount>0&&0===this.filter.matchCount;this.pattern&&o?null===(e=this.tree.options.showNotFoundMessage)||void 0===e||e?null===(t=this.widget)||void 0===t||t.showMessage({type:2,content:(0,S.NC)("not found","No elements found.")}):null===(i=this.widget)||void 0===i||i.showMessage({type:2}):null===(s=this.widget)||void 0===s||s.clearMessage()}shouldAllowFocus(e){return!this.widget||!this.pattern||(this.filter.totalCount>0&&this.filter.matchCount<=1||!C.CL.isDefault(e.filterData))}layout(e){var t;this.width=e,null===(t=this.widget)||void 0===t||t.layout(e)}dispose(){this._history=void 0,this._onDidChangePattern.dispose(),this.enabledDisposables.dispose(),this.disposables.dispose()}}function M(e,t){return e.position===t.position&&A(e,t)}function A(e,t){return e.node.element===t.node.element&&e.startIndex===t.startIndex&&e.height===t.height&&e.endIndex===t.endIndex}class R{constructor(e=[]){this.stickyNodes=e}get count(){return this.stickyNodes.length}equal(e){return(0,u.fS)(this.stickyNodes,e.stickyNodes,M)}lastNodePartiallyVisible(){if(0===this.count)return!1;const e=this.stickyNodes[this.count-1];if(1===this.count)return 0!==e.position;const t=this.stickyNodes[this.count-2];return t.position+t.height!==e.position}animationStateChanged(e){if(!(0,u.fS)(this.stickyNodes,e.stickyNodes,A))return!1;if(0===this.count)return!1;const t=this.stickyNodes[this.count-1],i=e.stickyNodes[e.count-1];return t.position!==i.position}}class O{constrainStickyScrollNodes(e,t,i){for(let s=0;s<e.length;s++){const o=e[s];if(o.position+o.height>i||s>=t)return e.slice(0,s)}return e}}class H extends b.JT{constructor(e,t,i,s,o,n={}){var r;super(),this.tree=e,this.model=t,this.view=i,this.treeDelegate=o,this.maxWidgetViewRatio=.4;const l=this.validateStickySettings(n);this.stickyScrollMaxItemCount=l.stickyScrollMaxItemCount,this.stickyScrollDelegate=null!==(r=n.stickyScrollDelegate)&&void 0!==r?r:new O,this._widget=this._register(new $(i.getScrollableElement(),i,e,s,o,n.accessibilityProvider)),this.onDidChangeHasFocus=this._widget.onDidChangeHasFocus,this.onContextMenu=this._widget.onContextMenu,this._register(i.onDidScroll((()=>this.update()))),this._register(i.onDidChangeContentHeight((()=>this.update()))),this._register(e.onDidChangeCollapseState((()=>this.update()))),this.update()}get height(){return this._widget.height}getNodeAtHeight(e){let t;if(t=0===e?this.view.firstVisibleIndex:this.view.indexAt(e+this.view.scrollTop),!(t<0||t>=this.view.length))return this.view.element(t)}update(){const e=this.getNodeAtHeight(0);if(!e||0===this.tree.scrollTop)return void this._widget.setState(void 0);const t=this.findStickyState(e);this._widget.setState(t)}findStickyState(e){const t=[];let i=e,s=0,o=this.getNextStickyNode(i,void 0,s);for(;o&&(t.push(o),s+=o.height,!(t.length<=this.stickyScrollMaxItemCount)||(i=this.getNextVisibleNode(o),i));)o=this.getNextStickyNode(i,o.node,s);const n=this.constrainStickyNodes(t);return n.length?new R(n):void 0}getNextVisibleNode(e){return this.getNodeAtHeight(e.position+e.height)}getNextStickyNode(e,t,i){const s=this.getAncestorUnderPrevious(e,t);if(s){if(s===e){if(!this.nodeIsUncollapsedParent(e))return;if(this.nodeTopAlignsWithStickyNodesBottom(e,i))return}return this.createStickyScrollNode(s,i)}}nodeTopAlignsWithStickyNodesBottom(e,t){const i=this.getNodeIndex(e),s=this.view.getElementTop(i),o=t;return this.view.scrollTop===s-o}createStickyScrollNode(e,t){const i=this.treeDelegate.getHeight(e),{startIndex:s,endIndex:o}=this.getNodeRange(e);return{node:e,position:this.calculateStickyNodePosition(o,t,i),height:i,startIndex:s,endIndex:o}}getAncestorUnderPrevious(e,t=void 0){let i=e,s=this.getParentNode(i);for(;s;){if(s===t)return i;i=s,s=this.getParentNode(i)}if(void 0===t)return i}calculateStickyNodePosition(e,t,i){let s=this.view.getRelativeTop(e);if(null===s&&this.view.firstVisibleIndex===e&&e+1<this.view.length){const t=this.treeDelegate.getHeight(this.view.element(e)),i=this.view.getRelativeTop(e+1);s=i?i-t/this.view.renderHeight:null}if(null===s)return t;const o=this.view.element(e),n=this.treeDelegate.getHeight(o),r=s*this.view.renderHeight+n;return t+i>r&&t<=r?r-i:t}constrainStickyNodes(e){if(0===e.length)return[];const t=this.view.renderHeight*this.maxWidgetViewRatio,i=e[e.length-1];if(e.length<=this.stickyScrollMaxItemCount&&i.position+i.height<=t)return e;const s=this.stickyScrollDelegate.constrainStickyScrollNodes(e,this.stickyScrollMaxItemCount,t);if(!s.length)return[];const o=s[s.length-1];if(s.length>this.stickyScrollMaxItemCount||o.position+o.height>t)throw new Error("stickyScrollDelegate violates constraints");return s}getParentNode(e){const t=this.model.getNodeLocation(e),i=this.model.getParentNodeLocation(t);return i?this.model.getNode(i):void 0}nodeIsUncollapsedParent(e){const t=this.model.getNodeLocation(e);return this.model.getListRenderCount(t)>1}getNodeIndex(e){const t=this.model.getNodeLocation(e);return this.model.getListIndex(t)}getNodeRange(e){const t=this.model.getNodeLocation(e),i=this.model.getListIndex(t);if(i<0)throw new Error("Node not found in tree");return{startIndex:i,endIndex:i+this.model.getListRenderCount(t)-1}}nodePositionTopBelowWidget(e){const t=[];let i=this.getParentNode(e);for(;i;)t.push(i),i=this.getParentNode(i);let s=0;for(let e=0;e<t.length&&e<this.stickyScrollMaxItemCount;e++)s+=this.treeDelegate.getHeight(t[e]);return s}domFocus(){this._widget.domFocus()}focusedLast(){return this._widget.focusedLast()}updateOptions(e={}){if(!e.stickyScrollMaxItemCount)return;const t=this.validateStickySettings(e);this.stickyScrollMaxItemCount!==t.stickyScrollMaxItemCount&&(this.stickyScrollMaxItemCount=t.stickyScrollMaxItemCount,this.update())}validateStickySettings(e){let t=7;return"number"==typeof e.stickyScrollMaxItemCount&&(t=Math.max(e.stickyScrollMaxItemCount,1)),{stickyScrollMaxItemCount:t}}}class ${constructor(e,t,i,s,n,r){this.view=t,this.tree=i,this.treeRenderers=s,this.treeDelegate=n,this.accessibilityProvider=r,this._previousElements=[],this._previousStateDisposables=new b.SL,this._rootDomNode=(0,o.$)(".monaco-tree-sticky-container.empty"),e.appendChild(this._rootDomNode);const l=(0,o.$)(".monaco-tree-sticky-container-shadow");this._rootDomNode.appendChild(l),this.stickyScrollFocus=new B(this._rootDomNode,t),this.onDidChangeHasFocus=this.stickyScrollFocus.onDidChangeHasFocus,this.onContextMenu=this.stickyScrollFocus.onContextMenu}get height(){if(!this._previousState)return 0;const e=this._previousState.stickyNodes[this._previousState.count-1];return e.position+e.height}setState(e){const t=!!this._previousState&&this._previousState.count>0,i=!!e&&e.count>0;if(!t&&!i||t&&i&&this._previousState.equal(e))return;if(t!==i&&this.setVisible(i),!i)return this._previousState=void 0,this._previousElements=[],void this._previousStateDisposables.clear();const s=e.stickyNodes[e.count-1];if(this._previousState&&e.animationStateChanged(this._previousState))this._previousElements[this._previousState.count-1].style.top=`${s.position}px`;else{this._previousStateDisposables.clear();const t=Array(e.count);for(let i=e.count-1;i>=0;i--){const s=e.stickyNodes[i],{element:o,disposable:n}=this.createElement(s,i,e.count);t[i]=o,this._rootDomNode.appendChild(o),this._previousStateDisposables.add(n)}this.stickyScrollFocus.updateElements(t,e),this._previousElements=t}this._previousState=e,this._rootDomNode.style.height=`${s.position+s.height}px`}createElement(e,t,i){const s=e.startIndex,o=document.createElement("div");o.style.top=`${e.position}px`,!1!==this.tree.options.setRowHeight&&(o.style.height=`${e.height}px`),!1!==this.tree.options.setRowLineHeight&&(o.style.lineHeight=`${e.height}px`),o.classList.add("monaco-tree-sticky-row"),o.classList.add("monaco-list-row"),o.setAttribute("data-index",`${s}`),o.setAttribute("data-parity",s%2==0?"even":"odd"),o.setAttribute("id",this.view.getElementID(s));const n=this.setAccessibilityAttributes(o,e.node.element,t,i),r=this.treeDelegate.getTemplateId(e.node),l=this.treeRenderers.find((e=>e.templateId===r));if(!l)throw new Error(`No renderer found for template id ${r}`);let d=e.node;d===this.tree.getNode(this.tree.getNodeLocation(e.node))&&(d=new Proxy(e.node,{}));const a=l.renderTemplate(o);l.renderElement(d,e.startIndex,a,e.height);const h=(0,b.OF)((()=>{n.dispose(),l.disposeElement(d,e.startIndex,a,e.height),l.disposeTemplate(a),o.remove()}));return{element:o,disposable:h}}setAccessibilityAttributes(e,t,i,s){var o;if(!this.accessibilityProvider)return b.JT.None;this.accessibilityProvider.getSetSize&&e.setAttribute("aria-setsize",String(this.accessibilityProvider.getSetSize(t,i,s))),this.accessibilityProvider.getPosInSet&&e.setAttribute("aria-posinset",String(this.accessibilityProvider.getPosInSet(t,i))),this.accessibilityProvider.getRole&&e.setAttribute("role",null!==(o=this.accessibilityProvider.getRole(t))&&void 0!==o?o:"treeitem");const n=this.accessibilityProvider.getAriaLabel(t),r=n&&"string"!=typeof n?n:(0,D.Dz)(n),l=(0,D.EH)((t=>{const i=t.readObservable(r);i?e.setAttribute("aria-label",i):e.removeAttribute("aria-label")}));"string"==typeof n||n&&e.setAttribute("aria-label",n.get());const d=this.accessibilityProvider.getAriaLevel&&this.accessibilityProvider.getAriaLevel(t);return"number"==typeof d&&e.setAttribute("aria-level",`${d}`),e.setAttribute("aria-selected",String(!1)),l}setVisible(e){this._rootDomNode.classList.toggle("empty",!e),e||this.stickyScrollFocus.updateElements([],void 0)}domFocus(){this.stickyScrollFocus.domFocus()}focusedLast(){return this.stickyScrollFocus.focusedLast()}dispose(){this.stickyScrollFocus.dispose(),this._previousStateDisposables.dispose(),this._rootDomNode.remove()}}class B extends b.JT{get domHasFocus(){return this._domHasFocus}set domHasFocus(e){e!==this._domHasFocus&&(this._onDidChangeHasFocus.fire(e),this._domHasFocus=e)}constructor(e,t){super(),this.container=e,this.view=t,this.focusedIndex=-1,this.elements=[],this._onDidChangeHasFocus=new f.Q5,this.onDidChangeHasFocus=this._onDidChangeHasFocus.event,this._onContextMenu=new f.Q5,this.onContextMenu=this._onContextMenu.event,this._domHasFocus=!1,this.container.addEventListener("focus",(()=>this.onFocus())),this.container.addEventListener("blur",(()=>this.onBlur())),this._register(this.view.onDidFocus((()=>this.toggleStickyScrollFocused(!1)))),this._register(this.view.onKeyDown((e=>this.onKeyDown(e)))),this._register(this.view.onMouseDown((e=>this.onMouseDown(e)))),this._register(this.view.onContextMenu((e=>this.handleContextMenu(e))))}handleContextMenu(e){const t=e.browserEvent.target;if(!(0,d.xf)(t)&&!(0,d.Et)(t))return void(this.focusedLast()&&this.view.domFocus());if(!(0,o.vd)(e.browserEvent)){if(!this.state)throw new Error("Context menu should not be triggered when state is undefined");const t=this.state.stickyNodes.findIndex((t=>{var i;return t.node.element===(null===(i=e.element)||void 0===i?void 0:i.element)}));if(-1===t)throw new Error("Context menu should not be triggered when element is not in sticky scroll widget");return this.container.focus(),void this.setFocus(t)}if(!this.state||this.focusedIndex<0)throw new Error("Context menu key should not be triggered when focus is not in sticky scroll widget");const i=this.state.stickyNodes[this.focusedIndex].node.element,s=this.elements[this.focusedIndex];this._onContextMenu.fire({element:i,anchor:s,browserEvent:e.browserEvent,isStickyScroll:!0})}onKeyDown(e){if(this.domHasFocus&&this.state)if("ArrowUp"===e.key)this.setFocusedElement(Math.max(0,this.focusedIndex-1)),e.preventDefault(),e.stopPropagation();else if("ArrowDown"===e.key||"ArrowRight"===e.key){if(this.focusedIndex>=this.state.count-1){const e=this.state.stickyNodes[this.state.count-1].startIndex+1;this.view.domFocus(),this.view.setFocus([e]),this.scrollNodeUnderWidget(e,this.state)}else this.setFocusedElement(this.focusedIndex+1);e.preventDefault(),e.stopPropagation()}}onMouseDown(e){const t=e.browserEvent.target;((0,d.xf)(t)||(0,d.Et)(t))&&(e.browserEvent.preventDefault(),e.browserEvent.stopPropagation())}updateElements(e,t){if(t&&0===t.count)throw new Error("Sticky scroll state must be undefined when there are no sticky nodes");if(t&&t.count!==e.length)throw new Error("Sticky scroll focus received illigel state");const i=this.focusedIndex;if(this.removeFocus(),this.elements=e,this.state=t,t){const e=(0,w.uZ)(i,0,t.count-1);this.setFocus(e)}else this.domHasFocus&&this.view.domFocus();this.container.tabIndex=t?0:-1}setFocusedElement(e){const t=this.state;if(!t)throw new Error("Cannot set focus when state is undefined");if(this.setFocus(e),!(e<t.count-1)&&t.lastNodePartiallyVisible()){const i=t.stickyNodes[e];this.scrollNodeUnderWidget(i.endIndex+1,t)}}scrollNodeUnderWidget(e,t){const i=t.stickyNodes[t.count-1],s=t.count>1?t.stickyNodes[t.count-2]:void 0,o=this.view.getElementTop(e),n=s?s.position+s.height+i.height:i.height;this.view.scrollTop=o-n}domFocus(){if(!this.state)throw new Error("Cannot focus when state is undefined");this.container.focus()}focusedLast(){return!!this.state&&this.view.getHTMLElement().classList.contains("sticky-scroll-focused")}removeFocus(){-1!==this.focusedIndex&&(this.toggleElementFocus(this.elements[this.focusedIndex],!1),this.focusedIndex=-1)}setFocus(e){if(0>e)throw new Error("addFocus() can not remove focus");if(!this.state&&e>=0)throw new Error("Cannot set focus index when state is undefined");if(this.state&&e>=this.state.count)throw new Error("Cannot set focus index to an index that does not exist");const t=this.focusedIndex;t>=0&&this.toggleElementFocus(this.elements[t],!1),e>=0&&this.toggleElementFocus(this.elements[e],!0),this.focusedIndex=e}toggleElementFocus(e,t){this.toggleElementActiveFocus(e,t&&this.domHasFocus),this.toggleElementPassiveFocus(e,t)}toggleCurrentElementActiveFocus(e){-1!==this.focusedIndex&&this.toggleElementActiveFocus(this.elements[this.focusedIndex],e)}toggleElementActiveFocus(e,t){e.classList.toggle("focused",t)}toggleElementPassiveFocus(e,t){e.classList.toggle("passive-focused",t)}toggleStickyScrollFocused(e){this.view.getHTMLElement().classList.toggle("sticky-scroll-focused",e)}onFocus(){if(!this.state||0===this.elements.length)throw new Error("Cannot focus when state is undefined or elements are empty");this.domHasFocus=!0,this.toggleStickyScrollFocused(!0),this.toggleCurrentElementActiveFocus(!0),-1===this.focusedIndex&&this.setFocus(0)}onBlur(){this.domHasFocus=!1,this.toggleCurrentElementActiveFocus(!1)}dispose(){this.toggleStickyScrollFocused(!1),this._onDidChangeHasFocus.fire(!1),super.dispose()}}function V(e){let t=c.sD.Unknown;return(0,o.uU)(e.browserEvent.target,"monaco-tl-twistie","monaco-tl-row")?t=c.sD.Twistie:(0,o.uU)(e.browserEvent.target,"monaco-tl-contents","monaco-tl-row")?t=c.sD.Element:(0,o.uU)(e.browserEvent.target,"monaco-tree-type-filter","monaco-list")&&(t=c.sD.Filter),{browserEvent:e.browserEvent,element:e.element?e.element.element:null,target:t}}function W(e){const t=(0,d.xf)(e.browserEvent.target);return{element:e.element?e.element.element:null,browserEvent:e.browserEvent,anchor:e.anchor,isStickyScroll:t}}function j(e,t){t(e),e.children.forEach((e=>j(e,t)))}class G{get nodeSet(){return this._nodeSet||(this._nodeSet=this.createNodeSet()),this._nodeSet}constructor(e,t){this.getFirstViewElementWithTrait=e,this.identityProvider=t,this.nodes=[],this._onDidChange=new f.Q5,this.onDidChange=this._onDidChange.event}set(e,t){!(null==t?void 0:t.__forceEvent)&&(0,u.fS)(this.nodes,e)||this._set(e,!1,t)}_set(e,t,i){if(this.nodes=[...e],this.elements=void 0,this._nodeSet=void 0,!t){const e=this;this._onDidChange.fire({get elements(){return e.get()},browserEvent:i})}}get(){return this.elements||(this.elements=this.nodes.map((e=>e.element))),[...this.elements]}getNodes(){return this.nodes}has(e){return this.nodeSet.has(e)}onDidModelSplice({insertedNodes:e,deletedNodes:t}){if(!this.identityProvider){const e=this.createNodeSet(),i=t=>e.delete(t);return t.forEach((e=>j(e,i))),void this.set([...e.values()])}const i=new Set,s=e=>i.add(this.identityProvider.getId(e.element).toString());t.forEach((e=>j(e,s)));const o=new Map,n=e=>o.set(this.identityProvider.getId(e.element).toString(),e);e.forEach((e=>j(e,n)));const r=[];for(const e of this.nodes){const t=this.identityProvider.getId(e.element).toString();if(i.has(t)){const e=o.get(t);e&&e.visible&&r.push(e)}else r.push(e)}if(this.nodes.length>0&&0===r.length){const e=this.getFirstViewElementWithTrait();e&&r.push(e)}this._set(r,!0)}createNodeSet(){const e=new Set;for(const t of this.nodes)e.add(t);return e}}class K extends d.sx{constructor(e,t,i){super(e),this.tree=t,this.stickyScrollProvider=i}onViewPointer(e){if((0,d.iK)(e.browserEvent.target)||(0,d.cK)(e.browserEvent.target)||(0,d.hD)(e.browserEvent.target))return;if(e.browserEvent.isHandledByList)return;const t=e.element;if(!t)return super.onViewPointer(e);if(this.isSelectionRangeChangeEvent(e)||this.isSelectionSingleChangeEvent(e))return super.onViewPointer(e);const i=e.browserEvent.target,s=i.classList.contains("monaco-tl-twistie")||i.classList.contains("monaco-icon-label")&&i.classList.contains("folder-icon")&&e.browserEvent.offsetX<16,o=(0,d.Et)(e.browserEvent.target);let n=!1;if(n=!!o||("function"==typeof this.tree.expandOnlyOnTwistieClick?this.tree.expandOnlyOnTwistieClick(t.element):!!this.tree.expandOnlyOnTwistieClick),o)this.handleStickyScrollMouseEvent(e,t);else{if(n&&!s&&2!==e.browserEvent.detail)return super.onViewPointer(e);if(!this.tree.expandOnDoubleClick&&2===e.browserEvent.detail)return super.onViewPointer(e)}if(t.collapsible&&(!o||s)){const i=this.tree.getNodeLocation(t),o=e.browserEvent.altKey;if(this.tree.setFocus([i]),this.tree.toggleCollapsed(i,o),s)return void(e.browserEvent.isHandledByList=!0)}o||super.onViewPointer(e)}handleStickyScrollMouseEvent(e,t){if((0,d.$B)(e.browserEvent.target)||(0,d.dk)(e.browserEvent.target))return;const i=this.stickyScrollProvider();if(!i)throw new Error("Sticky scroll controller not found");const s=this.list.indexOf(t),o=this.list.getElementTop(s),n=i.nodePositionTopBelowWidget(t);this.tree.scrollTop=o-n,this.list.domFocus(),this.list.setFocus([s]),this.list.setSelection([s])}onDoubleClick(e){!e.browserEvent.target.classList.contains("monaco-tl-twistie")&&this.tree.expandOnDoubleClick&&(e.browserEvent.isHandledByList||super.onDoubleClick(e))}onMouseDown(e){const t=e.browserEvent.target;(0,d.xf)(t)||(0,d.Et)(t)||super.onMouseDown(e)}onContextMenu(e){const t=e.browserEvent.target;(0,d.xf)(t)||(0,d.Et)(t)||super.onContextMenu(e)}}class z extends d.aV{constructor(e,t,i,s,o,n,r,l){super(e,t,i,s,l),this.focusTrait=o,this.selectionTrait=n,this.anchorTrait=r}createMouseController(e){return new K(this,e.tree,e.stickyScrollProvider)}splice(e,t,i=[]){if(super.splice(e,t,i),0===i.length)return;const s=[],o=[];let n;i.forEach(((t,i)=>{this.focusTrait.has(t)&&s.push(e+i),this.selectionTrait.has(t)&&o.push(e+i),this.anchorTrait.has(t)&&(n=e+i)})),s.length>0&&super.setFocus((0,u.EB)([...super.getFocus(),...s])),o.length>0&&super.setSelection((0,u.EB)([...super.getSelection(),...o])),"number"==typeof n&&super.setAnchor(n)}setFocus(e,t,i=!1){super.setFocus(e,t),i||this.focusTrait.set(e.map((e=>this.element(e))),t)}setSelection(e,t,i=!1){super.setSelection(e,t),i||this.selectionTrait.set(e.map((e=>this.element(e))),t)}setAnchor(e,t=!1){super.setAnchor(e),t||(void 0===e?this.anchorTrait.set([]):this.anchorTrait.set([this.element(e)]))}}class U{get onDidScroll(){return this.view.onDidScroll}get onDidChangeFocus(){return this.eventBufferer.wrapEvent(this.focus.onDidChange)}get onDidChangeSelection(){return this.eventBufferer.wrapEvent(this.selection.onDidChange)}get onMouseDblClick(){return f.ju.filter(f.ju.map(this.view.onMouseDblClick,V),(e=>e.target!==c.sD.Filter))}get onMouseOver(){return f.ju.map(this.view.onMouseOver,V)}get onMouseOut(){return f.ju.map(this.view.onMouseOut,V)}get onContextMenu(){var e,t;return f.ju.any(f.ju.filter(f.ju.map(this.view.onContextMenu,W),(e=>!e.isStickyScroll)),null!==(t=null===(e=this.stickyScrollController)||void 0===e?void 0:e.onContextMenu)&&void 0!==t?t:f.ju.None)}get onPointer(){return f.ju.map(this.view.onPointer,V)}get onKeyDown(){return this.view.onKeyDown}get onDidFocus(){return this.view.onDidFocus}get onDidChangeModel(){return f.ju.signal(this.model.onDidSplice)}get onDidChangeCollapseState(){return this.model.onDidChangeCollapseState}get findMode(){var e,t;return null!==(t=null===(e=this.findController)||void 0===e?void 0:e.mode)&&void 0!==t?t:T.Highlight}set findMode(e){this.findController&&(this.findController.mode=e)}get findMatchType(){var e,t;return null!==(t=null===(e=this.findController)||void 0===e?void 0:e.matchType)&&void 0!==t?t:F.Fuzzy}set findMatchType(e){this.findController&&(this.findController.matchType=e)}get expandOnDoubleClick(){return void 0===this._options.expandOnDoubleClick||this._options.expandOnDoubleClick}get expandOnlyOnTwistieClick(){return void 0===this._options.expandOnlyOnTwistieClick||this._options.expandOnlyOnTwistieClick}get onDidDispose(){return this.view.onDidDispose}constructor(e,t,i,r,l={}){var a;this._user=e,this._options=l,this.eventBufferer=new f.E7,this.onDidChangeFindOpenState=f.ju.None,this.onDidChangeStickyScrollFocused=f.ju.None,this.disposables=new b.SL,this._onWillRefilter=new f.Q5,this.onWillRefilter=this._onWillRefilter.event,this._onDidUpdateOptions=new f.Q5,this.treeDelegate=new x(i);const h=new f.ZD,c=new f.ZD,u=this.disposables.add(new P(c.event)),g=new v.ri;this.renderers=r.map((e=>new _(e,(()=>this.model),h.event,u,g,l)));for(const e of this.renderers)this.disposables.add(e);let m;var C,w;l.keyboardNavigationLabelProvider&&(m=new I(this,l.keyboardNavigationLabelProvider,l.filter),l={...l,filter:m},this.disposables.add(m)),this.focus=new G((()=>this.view.getFocusedElements()[0]),l.identityProvider),this.selection=new G((()=>this.view.getSelectedElements()[0]),l.identityProvider),this.anchor=new G((()=>this.view.getAnchorElement()),l.identityProvider),this.view=new z(e,t,this.treeDelegate,this.renderers,this.focus,this.selection,this.anchor,{...(C=()=>this.model,w=l,w&&{...w,identityProvider:w.identityProvider&&{getId:e=>w.identityProvider.getId(e.element)},dnd:w.dnd&&new k(C,w.dnd),multipleSelectionController:w.multipleSelectionController&&{isSelectionSingleChangeEvent:e=>w.multipleSelectionController.isSelectionSingleChangeEvent({...e,element:e.element}),isSelectionRangeChangeEvent:e=>w.multipleSelectionController.isSelectionRangeChangeEvent({...e,element:e.element})},accessibilityProvider:w.accessibilityProvider&&{...w.accessibilityProvider,getSetSize(e){const t=C(),i=t.getNodeLocation(e),s=t.getParentNodeLocation(i);return t.getNode(s).visibleChildrenCount},getPosInSet:e=>e.visibleChildIndex+1,isChecked:w.accessibilityProvider&&w.accessibilityProvider.isChecked?e=>w.accessibilityProvider.isChecked(e.element):void 0,getRole:w.accessibilityProvider&&w.accessibilityProvider.getRole?e=>w.accessibilityProvider.getRole(e.element):()=>"treeitem",getAriaLabel:e=>w.accessibilityProvider.getAriaLabel(e.element),getWidgetAriaLabel:()=>w.accessibilityProvider.getWidgetAriaLabel(),getWidgetRole:w.accessibilityProvider&&w.accessibilityProvider.getWidgetRole?()=>w.accessibilityProvider.getWidgetRole():()=>"tree",getAriaLevel:w.accessibilityProvider&&w.accessibilityProvider.getAriaLevel?e=>w.accessibilityProvider.getAriaLevel(e.element):e=>e.depth,getActiveDescendantId:w.accessibilityProvider.getActiveDescendantId&&(e=>w.accessibilityProvider.getActiveDescendantId(e.element))},keyboardNavigationLabelProvider:w.keyboardNavigationLabelProvider&&{...w.keyboardNavigationLabelProvider,getKeyboardNavigationLabel:e=>w.keyboardNavigationLabelProvider.getKeyboardNavigationLabel(e.element)}}),tree:this,stickyScrollProvider:()=>this.stickyScrollController}),this.model=this.createModel(e,this.view,l),h.input=this.model.onDidChangeCollapseState;const y=f.ju.forEach(this.model.onDidSplice,(e=>{this.eventBufferer.bufferEvents((()=>{this.focus.onDidModelSplice(e),this.selection.onDidModelSplice(e)}))}),this.disposables);y((()=>null),null,this.disposables);const S=this.disposables.add(new f.Q5),D=this.disposables.add(new p.vp(0));if(this.disposables.add(f.ju.any(y,this.focus.onDidChange,this.selection.onDidChange)((()=>{D.trigger((()=>{const e=new Set;for(const t of this.focus.getNodes())e.add(t);for(const t of this.selection.getNodes())e.add(t);S.fire([...e.values()])}))}))),c.input=S.event,!1!==l.keyboardSupport){const e=f.ju.chain(this.view.onKeyDown,(e=>e.filter((e=>!(0,d.cK)(e.target))).map((e=>new n.y(e)))));f.ju.chain(e,(e=>e.filter((e=>15===e.keyCode))))(this.onLeftArrow,this,this.disposables),f.ju.chain(e,(e=>e.filter((e=>17===e.keyCode))))(this.onRightArrow,this,this.disposables),f.ju.chain(e,(e=>e.filter((e=>10===e.keyCode))))(this.onSpace,this,this.disposables)}if((null===(a=l.findWidgetEnabled)||void 0===a||a)&&l.keyboardNavigationLabelProvider&&l.contextViewProvider){const e=this.options.findWidgetStyles?{styles:this.options.findWidgetStyles}:void 0;this.findController=new L(this,this.model,this.view,m,l.contextViewProvider,e),this.focusNavigationFilter=e=>this.findController.shouldAllowFocus(e),this.onDidChangeFindOpenState=this.findController.onDidChangeOpenState,this.disposables.add(this.findController),this.onDidChangeFindMode=this.findController.onDidChangeMode,this.onDidChangeFindMatchType=this.findController.onDidChangeMatchType}else this.onDidChangeFindMode=f.ju.None,this.onDidChangeFindMatchType=f.ju.None;l.enableStickyScroll&&(this.stickyScrollController=new H(this,this.model,this.view,this.renderers,this.treeDelegate,l),this.onDidChangeStickyScrollFocused=this.stickyScrollController.onDidChangeHasFocus),this.styleElement=(0,o.dS)(this.view.getHTMLElement()),this.getHTMLElement().classList.toggle("always",this._options.renderIndentGuides===s.Always)}updateOptions(e={}){var t;this._options={...this._options,...e};for(const t of this.renderers)t.updateOptions(e);this.view.updateOptions(this._options),null===(t=this.findController)||void 0===t||t.updateOptions(e),this.updateStickyScroll(e),this._onDidUpdateOptions.fire(this._options),this.getHTMLElement().classList.toggle("always",this._options.renderIndentGuides===s.Always)}get options(){return this._options}updateStickyScroll(e){var t;!this.stickyScrollController&&this._options.enableStickyScroll?(this.stickyScrollController=new H(this,this.model,this.view,this.renderers,this.treeDelegate,this._options),this.onDidChangeStickyScrollFocused=this.stickyScrollController.onDidChangeHasFocus):this.stickyScrollController&&!this._options.enableStickyScroll&&(this.onDidChangeStickyScrollFocused=f.ju.None,this.stickyScrollController.dispose(),this.stickyScrollController=void 0),null===(t=this.stickyScrollController)||void 0===t||t.updateOptions(e)}getHTMLElement(){return this.view.getHTMLElement()}get scrollTop(){return this.view.scrollTop}set scrollTop(e){this.view.scrollTop=e}get scrollHeight(){return this.view.scrollHeight}get renderHeight(){return this.view.renderHeight}get ariaLabel(){return this.view.ariaLabel}set ariaLabel(e){this.view.ariaLabel=e}domFocus(){var e;(null===(e=this.stickyScrollController)||void 0===e?void 0:e.focusedLast())?this.stickyScrollController.domFocus():this.view.domFocus()}layout(e,t){var i;this.view.layout(e,t),(0,y.hj)(t)&&(null===(i=this.findController)||void 0===i||i.layout(t))}style(e){var t,i;const s=`.${this.view.domId}`,n=[];e.treeIndentGuidesStroke&&(n.push(`.monaco-list${s}:hover .monaco-tl-indent > .indent-guide, .monaco-list${s}.always .monaco-tl-indent > .indent-guide  { border-color: ${e.treeInactiveIndentGuidesStroke}; }`),n.push(`.monaco-list${s} .monaco-tl-indent > .indent-guide.active { border-color: ${e.treeIndentGuidesStroke}; }`));const r=null!==(t=e.treeStickyScrollBackground)&&void 0!==t?t:e.listBackground;r&&(n.push(`.monaco-list${s} .monaco-scrollable-element .monaco-tree-sticky-container { background-color: ${r}; }`),n.push(`.monaco-list${s} .monaco-scrollable-element .monaco-tree-sticky-container .monaco-tree-sticky-row { background-color: ${r}; }`)),e.treeStickyScrollBorder&&n.push(`.monaco-list${s} .monaco-scrollable-element .monaco-tree-sticky-container { border-bottom: 1px solid ${e.treeStickyScrollBorder}; }`),e.treeStickyScrollShadow&&n.push(`.monaco-list${s} .monaco-scrollable-element .monaco-tree-sticky-container .monaco-tree-sticky-container-shadow { box-shadow: ${e.treeStickyScrollShadow} 0 6px 6px -6px inset; height: 3px; }`),e.listFocusForeground&&(n.push(`.monaco-list${s}.sticky-scroll-focused .monaco-scrollable-element .monaco-tree-sticky-container:focus .monaco-list-row.focused { color: ${e.listFocusForeground}; }`),n.push(`.monaco-list${s}:not(.sticky-scroll-focused) .monaco-scrollable-element .monaco-tree-sticky-container .monaco-list-row.focused { color: inherit; }`));const l=(0,o.XT)(e.listFocusAndSelectionOutline,(0,o.XT)(e.listSelectionOutline,null!==(i=e.listFocusOutline)&&void 0!==i?i:""));l&&(n.push(`.monaco-list${s}.sticky-scroll-focused .monaco-scrollable-element .monaco-tree-sticky-container:focus .monaco-list-row.focused.selected { outline: 1px solid ${l}; outline-offset: -1px;}`),n.push(`.monaco-list${s}:not(.sticky-scroll-focused) .monaco-scrollable-element .monaco-tree-sticky-container .monaco-list-row.focused.selected { outline: inherit;}`)),e.listFocusOutline&&(n.push(`.monaco-list${s}.sticky-scroll-focused .monaco-scrollable-element .monaco-tree-sticky-container:focus .monaco-list-row.focused { outline: 1px solid ${e.listFocusOutline}; outline-offset: -1px; }`),n.push(`.monaco-list${s}:not(.sticky-scroll-focused) .monaco-scrollable-element .monaco-tree-sticky-container .monaco-list-row.focused { outline: inherit; }`),n.push(`.monaco-workbench.context-menu-visible .monaco-list${s}.last-focused.sticky-scroll-focused .monaco-scrollable-element .monaco-tree-sticky-container .monaco-list-row.passive-focused { outline: 1px solid ${e.listFocusOutline}; outline-offset: -1px; }`),n.push(`.monaco-workbench.context-menu-visible .monaco-list${s}.last-focused.sticky-scroll-focused .monaco-list-rows .monaco-list-row.focused { outline: inherit; }`),n.push(`.monaco-workbench.context-menu-visible .monaco-list${s}.last-focused:not(.sticky-scroll-focused) .monaco-tree-sticky-container .monaco-list-rows .monaco-list-row.focused { outline: inherit; }`)),this.styleElement.textContent=n.join("\n"),this.view.style(e)}getParentElement(e){const t=this.model.getParentNodeLocation(e);return this.model.getNode(t).element}getFirstElementChild(e){return this.model.getFirstElementChild(e)}getNode(e){return this.model.getNode(e)}getNodeLocation(e){return this.model.getNodeLocation(e)}collapse(e,t=!1){return this.model.setCollapsed(e,!0,t)}expand(e,t=!1){return this.model.setCollapsed(e,!1,t)}toggleCollapsed(e,t=!1){return this.model.setCollapsed(e,void 0,t)}isCollapsible(e){return this.model.isCollapsible(e)}setCollapsible(e,t){return this.model.setCollapsible(e,t)}isCollapsed(e){return this.model.isCollapsed(e)}refilter(){this._onWillRefilter.fire(void 0),this.model.refilter()}setSelection(e,t){this.eventBufferer.bufferEvents((()=>{const i=e.map((e=>this.model.getNode(e)));this.selection.set(i,t);const s=e.map((e=>this.model.getListIndex(e))).filter((e=>e>-1));this.view.setSelection(s,t,!0)}))}getSelection(){return this.selection.get()}setFocus(e,t){this.eventBufferer.bufferEvents((()=>{const i=e.map((e=>this.model.getNode(e)));this.focus.set(i,t);const s=e.map((e=>this.model.getListIndex(e))).filter((e=>e>-1));this.view.setFocus(s,t,!0)}))}focusNext(e=1,t=!1,i,s=((0,o.vd)(i)&&i.altKey?void 0:this.focusNavigationFilter)){this.view.focusNext(e,t,i,s)}focusPrevious(e=1,t=!1,i,s=((0,o.vd)(i)&&i.altKey?void 0:this.focusNavigationFilter)){this.view.focusPrevious(e,t,i,s)}focusNextPage(e,t=((0,o.vd)(e)&&e.altKey?void 0:this.focusNavigationFilter)){return this.view.focusNextPage(e,t)}focusPreviousPage(e,t=((0,o.vd)(e)&&e.altKey?void 0:this.focusNavigationFilter)){return this.view.focusPreviousPage(e,t,(()=>{var e,t;return null!==(t=null===(e=this.stickyScrollController)||void 0===e?void 0:e.height)&&void 0!==t?t:0}))}focusFirst(e,t=((0,o.vd)(e)&&e.altKey?void 0:this.focusNavigationFilter)){this.view.focusFirst(e,t)}getFocus(){return this.focus.get()}reveal(e,t){this.model.expandTo(e);const i=this.model.getListIndex(e);if(-1!==i)if(this.stickyScrollController){const s=this.stickyScrollController.nodePositionTopBelowWidget(this.getNode(e));this.view.reveal(i,t,s)}else this.view.reveal(i,t)}onLeftArrow(e){e.preventDefault(),e.stopPropagation();const t=this.view.getFocusedElements();if(0===t.length)return;const i=t[0],s=this.model.getNodeLocation(i);if(!this.model.setCollapsed(s,!0)){const e=this.model.getParentNodeLocation(s);if(!e)return;const t=this.model.getListIndex(e);this.view.reveal(t),this.view.setFocus([t])}}onRightArrow(e){e.preventDefault(),e.stopPropagation();const t=this.view.getFocusedElements();if(0===t.length)return;const i=t[0],s=this.model.getNodeLocation(i);if(!this.model.setCollapsed(s,!1)){if(!i.children.some((e=>e.visible)))return;const[e]=this.view.getFocus(),t=e+1;this.view.reveal(t),this.view.setFocus([t])}}onSpace(e){e.preventDefault(),e.stopPropagation();const t=this.view.getFocusedElements();if(0===t.length)return;const i=t[0],s=this.model.getNodeLocation(i),o=e.browserEvent.altKey;this.model.setCollapsed(s,void 0,o)}dispose(){var e;(0,b.B9)(this.disposables),null===(e=this.stickyScrollController)||void 0===e||e.dispose(),this.view.dispose()}}},6126:(e,t,i)=>{i.d(t,{c:()=>x,h:()=>I});var s=i(25707),o=i(5637),n=i(71782),r=i(16354),l=i(60350),d=i(15393),a=i(32429),h=i(25670),c=i(17301),u=i(4669),p=i(53725),g=i(5976),m=i(98401);function v(e){return{...e,children:[],refreshPromise:void 0,stale:!0,slow:!1,forceExpanded:!1}}function f(e,t){return!!t.parent&&(t.parent===e||f(e,t.parent))}class C{get element(){return this.node.element.element}get children(){return this.node.children.map((e=>new C(e)))}get depth(){return this.node.depth}get visibleChildrenCount(){return this.node.visibleChildrenCount}get visibleChildIndex(){return this.node.visibleChildIndex}get collapsible(){return this.node.collapsible}get collapsed(){return this.node.collapsed}get visible(){return this.node.visible}get filterData(){return this.node.filterData}constructor(e){this.node=e}}class b{constructor(e,t,i){this.renderer=e,this.nodeMapper=t,this.onDidChangeTwistieState=i,this.renderedNodes=new Map,this.templateId=e.templateId}renderTemplate(e){return{templateData:this.renderer.renderTemplate(e)}}renderElement(e,t,i,s){this.renderer.renderElement(this.nodeMapper.map(e),t,i.templateData,s)}renderTwistie(e,t){return e.slow?(t.classList.add(...h.k.asClassNameArray(a.l.treeItemLoading)),!0):(t.classList.remove(...h.k.asClassNameArray(a.l.treeItemLoading)),!1)}disposeElement(e,t,i,s){var o,n;null===(n=(o=this.renderer).disposeElement)||void 0===n||n.call(o,this.nodeMapper.map(e),t,i.templateData,s)}disposeTemplate(e){this.renderer.disposeTemplate(e.templateData)}dispose(){this.renderedNodes.clear()}}function w(e){return{browserEvent:e.browserEvent,elements:e.elements.map((e=>e.element))}}function y(e){return{browserEvent:e.browserEvent,element:e.element&&e.element.element,target:e.target}}class S extends s.kX{constructor(e){super(e.elements.map((e=>e.element))),this.data=e}}function D(e){return e instanceof s.kX?new S(e):e}class N{constructor(e){this.dnd=e}getDragURI(e){return this.dnd.getDragURI(e.element)}getDragLabel(e,t){if(this.dnd.getDragLabel)return this.dnd.getDragLabel(e.map((e=>e.element)),t)}onDragStart(e,t){var i,s;null===(s=(i=this.dnd).onDragStart)||void 0===s||s.call(i,D(e),t)}onDragOver(e,t,i,s,o,n=!0){return this.dnd.onDragOver(D(e),t&&t.element,i,s,o)}drop(e,t,i,s,o){this.dnd.drop(D(e),t&&t.element,i,s,o)}onDragEnd(e){var t,i;null===(i=(t=this.dnd).onDragEnd)||void 0===i||i.call(t,e)}dispose(){this.dnd.dispose()}}function E(e){return e&&{...e,collapseByDefault:!0,identityProvider:e.identityProvider&&{getId:t=>e.identityProvider.getId(t.element)},dnd:e.dnd&&new N(e.dnd),multipleSelectionController:e.multipleSelectionController&&{isSelectionSingleChangeEvent:t=>e.multipleSelectionController.isSelectionSingleChangeEvent({...t,element:t.element}),isSelectionRangeChangeEvent:t=>e.multipleSelectionController.isSelectionRangeChangeEvent({...t,element:t.element})},accessibilityProvider:e.accessibilityProvider&&{...e.accessibilityProvider,getPosInSet:void 0,getSetSize:void 0,getRole:e.accessibilityProvider.getRole?t=>e.accessibilityProvider.getRole(t.element):()=>"treeitem",isChecked:e.accessibilityProvider.isChecked?t=>{var i;return!!(null===(i=e.accessibilityProvider)||void 0===i?void 0:i.isChecked(t.element))}:void 0,getAriaLabel:t=>e.accessibilityProvider.getAriaLabel(t.element),getWidgetAriaLabel:()=>e.accessibilityProvider.getWidgetAriaLabel(),getWidgetRole:e.accessibilityProvider.getWidgetRole?()=>e.accessibilityProvider.getWidgetRole():()=>"tree",getAriaLevel:e.accessibilityProvider.getAriaLevel&&(t=>e.accessibilityProvider.getAriaLevel(t.element)),getActiveDescendantId:e.accessibilityProvider.getActiveDescendantId&&(t=>e.accessibilityProvider.getActiveDescendantId(t.element))},filter:e.filter&&{filter:(t,i)=>e.filter.filter(t.element,i)},keyboardNavigationLabelProvider:e.keyboardNavigationLabelProvider&&{...e.keyboardNavigationLabelProvider,getKeyboardNavigationLabel:t=>e.keyboardNavigationLabelProvider.getKeyboardNavigationLabel(t.element)},sorter:void 0,expandOnlyOnTwistieClick:void 0===e.expandOnlyOnTwistieClick?void 0:"function"!=typeof e.expandOnlyOnTwistieClick?e.expandOnlyOnTwistieClick:t=>e.expandOnlyOnTwistieClick(t.element),defaultFindVisibility:t=>t.hasChildren&&t.stale?1:"number"==typeof e.defaultFindVisibility?e.defaultFindVisibility:void 0===e.defaultFindVisibility?2:e.defaultFindVisibility(t.element)}}function k(e,t){t(e),e.children.forEach((e=>k(e,t)))}class x{get onDidScroll(){return this.tree.onDidScroll}get onDidChangeFocus(){return u.ju.map(this.tree.onDidChangeFocus,w)}get onDidChangeSelection(){return u.ju.map(this.tree.onDidChangeSelection,w)}get onMouseDblClick(){return u.ju.map(this.tree.onMouseDblClick,y)}get onPointer(){return u.ju.map(this.tree.onPointer,y)}get onDidFocus(){return this.tree.onDidFocus}get onDidChangeModel(){return this.tree.onDidChangeModel}get onDidChangeCollapseState(){return this.tree.onDidChangeCollapseState}get onDidChangeFindOpenState(){return this.tree.onDidChangeFindOpenState}get onDidChangeStickyScrollFocused(){return this.tree.onDidChangeStickyScrollFocused}get onDidDispose(){return this.tree.onDidDispose}constructor(e,t,i,s,o,n={}){this.user=e,this.dataSource=o,this.nodes=new Map,this.subTreeRefreshPromises=new Map,this.refreshPromises=new Map,this._onDidRender=new u.Q5,this._onDidChangeNodeSlowState=new u.Q5,this.nodeMapper=new l.VA((e=>new C(e))),this.disposables=new g.SL,this.identityProvider=n.identityProvider,this.autoExpandSingleChildren=void 0!==n.autoExpandSingleChildren&&n.autoExpandSingleChildren,this.sorter=n.sorter,this.getDefaultCollapseState=e=>n.collapseByDefault?n.collapseByDefault(e)?l.kn.PreserveOrCollapsed:l.kn.PreserveOrExpanded:void 0,this.tree=this.createTree(e,t,i,s,n),this.onDidChangeFindMode=this.tree.onDidChangeFindMode,this.onDidChangeFindMatchType=this.tree.onDidChangeFindMatchType,this.root=v({element:void 0,parent:null,hasChildren:!0,defaultCollapseState:void 0}),this.identityProvider&&(this.root={...this.root,id:null}),this.nodes.set(null,this.root),this.tree.onDidChangeCollapseState(this._onDidChangeCollapseState,this,this.disposables)}createTree(e,t,i,s,n){const l=new o.cz(i),d=s.map((e=>new b(e,this.nodeMapper,this._onDidChangeNodeSlowState.event))),a=E(n)||{};return new r.H(e,t,l,d,a)}updateOptions(e={}){this.tree.updateOptions(e)}getHTMLElement(){return this.tree.getHTMLElement()}get scrollTop(){return this.tree.scrollTop}set scrollTop(e){this.tree.scrollTop=e}get scrollHeight(){return this.tree.scrollHeight}get renderHeight(){return this.tree.renderHeight}domFocus(){this.tree.domFocus()}layout(e,t){this.tree.layout(e,t)}style(e){this.tree.style(e)}getInput(){return this.root.element}async setInput(e,t){this.refreshPromises.forEach((e=>e.cancel())),this.refreshPromises.clear(),this.root.element=e;const i=t&&{viewState:t,focus:[],selection:[]};await this._updateChildren(e,!0,!1,i),i&&(this.tree.setFocus(i.focus),this.tree.setSelection(i.selection)),t&&"number"==typeof t.scrollTop&&(this.scrollTop=t.scrollTop)}async _updateChildren(e=this.root.element,t=!0,i=!1,s,o){if(void 0===this.root.element)throw new l.ac(this.user,"Tree input not set");this.root.refreshPromise&&(await this.root.refreshPromise,await u.ju.toPromise(this._onDidRender.event));const n=this.getDataNode(e);if(await this.refreshAndRenderNode(n,t,s,o),i)try{this.tree.rerender(n)}catch(e){}}rerender(e){if(void 0===e||e===this.root.element)return void this.tree.rerender();const t=this.getDataNode(e);this.tree.rerender(t)}getNode(e=this.root.element){const t=this.getDataNode(e),i=this.tree.getNode(t===this.root?null:t);return this.nodeMapper.map(i)}collapse(e,t=!1){const i=this.getDataNode(e);return this.tree.collapse(i===this.root?null:i,t)}async expand(e,t=!1){if(void 0===this.root.element)throw new l.ac(this.user,"Tree input not set");this.root.refreshPromise&&(await this.root.refreshPromise,await u.ju.toPromise(this._onDidRender.event));const i=this.getDataNode(e);if(this.tree.hasElement(i)&&!this.tree.isCollapsible(i))return!1;if(i.refreshPromise&&(await this.root.refreshPromise,await u.ju.toPromise(this._onDidRender.event)),i!==this.root&&!i.refreshPromise&&!this.tree.isCollapsed(i))return!1;const s=this.tree.expand(i===this.root?null:i,t);return i.refreshPromise&&(await this.root.refreshPromise,await u.ju.toPromise(this._onDidRender.event)),s}setSelection(e,t){const i=e.map((e=>this.getDataNode(e)));this.tree.setSelection(i,t)}getSelection(){return this.tree.getSelection().map((e=>e.element))}setFocus(e,t){const i=e.map((e=>this.getDataNode(e)));this.tree.setFocus(i,t)}getFocus(){return this.tree.getFocus().map((e=>e.element))}reveal(e,t){this.tree.reveal(this.getDataNode(e),t)}getParentElement(e){const t=this.tree.getParentElement(this.getDataNode(e));return t&&t.element}getFirstElementChild(e=this.root.element){const t=this.getDataNode(e),i=this.tree.getFirstElementChild(t===this.root?null:t);return i&&i.element}getDataNode(e){const t=this.nodes.get(e===this.root.element?null:e);if(!t)throw new l.ac(this.user,`Data tree node not found: ${e}`);return t}async refreshAndRenderNode(e,t,i,s){await this.refreshNode(e,t,i),this.disposables.isDisposed||this.render(e,i,s)}async refreshNode(e,t,i){let s;if(this.subTreeRefreshPromises.forEach(((o,n)=>{!s&&function(e,t){return e===t||f(e,t)||f(t,e)}(n,e)&&(s=o.then((()=>this.refreshNode(e,t,i))))})),s)return s;if(e!==this.root){if(this.tree.getNode(e).collapsed)return e.hasChildren=!!this.dataSource.hasChildren(e.element),e.stale=!0,void this.setChildren(e,[],t,i)}return this.doRefreshSubTree(e,t,i)}async doRefreshSubTree(e,t,i){let s;e.refreshPromise=new Promise((e=>s=e)),this.subTreeRefreshPromises.set(e,e.refreshPromise),e.refreshPromise.finally((()=>{e.refreshPromise=void 0,this.subTreeRefreshPromises.delete(e)}));try{const s=await this.doRefreshNode(e,t,i);e.stale=!1,await d.jT.settled(s.map((e=>this.doRefreshSubTree(e,t,i))))}finally{s()}}async doRefreshNode(e,t,i){let s;if(e.hasChildren=!!this.dataSource.hasChildren(e.element),e.hasChildren){const t=this.doGetChildren(e);if((0,m.TW)(t))s=Promise.resolve(t);else{const i=(0,d.Vs)(800);i.then((()=>{e.slow=!0,this._onDidChangeNodeSlowState.fire(e)}),(e=>null)),s=t.finally((()=>i.cancel()))}}else s=Promise.resolve(p.$.empty());try{const o=await s;return this.setChildren(e,o,t,i)}catch(t){if(e!==this.root&&this.tree.hasElement(e)&&this.tree.collapse(e),(0,c.n2)(t))return[];throw t}finally{e.slow&&(e.slow=!1,this._onDidChangeNodeSlowState.fire(e))}}doGetChildren(e){let t=this.refreshPromises.get(e);if(t)return t;const i=this.dataSource.getChildren(e.element);return(0,m.TW)(i)?this.processChildren(i):(t=(0,d.PG)((async()=>this.processChildren(await i))),this.refreshPromises.set(e,t),t.finally((()=>{this.refreshPromises.delete(e)})))}_onDidChangeCollapseState({node:e,deep:t}){null!==e.element&&!e.collapsed&&e.element.stale&&(t?this.collapse(e.element.element):this.refreshAndRenderNode(e.element,!1).catch(c.dL))}setChildren(e,t,i,s){const o=[...t];if(0===e.children.length&&0===o.length)return[];const n=new Map,r=new Map;for(const t of e.children)n.set(t.element,t),this.identityProvider&&r.set(t.id,{node:t,collapsed:this.tree.hasElement(t)&&this.tree.isCollapsed(t)});const d=[],a=o.map((t=>{const o=!!this.dataSource.hasChildren(t);if(!this.identityProvider){const i=v({element:t,parent:e,hasChildren:o,defaultCollapseState:this.getDefaultCollapseState(t)});return o&&i.defaultCollapseState===l.kn.PreserveOrExpanded&&d.push(i),i}const a=this.identityProvider.getId(t).toString(),h=r.get(a);if(h){const e=h.node;return n.delete(e.element),this.nodes.delete(e.element),this.nodes.set(t,e),e.element=t,e.hasChildren=o,i?h.collapsed?(e.children.forEach((e=>k(e,(e=>this.nodes.delete(e.element))))),e.children.splice(0,e.children.length),e.stale=!0):d.push(e):o&&!h.collapsed&&d.push(e),e}const c=v({element:t,parent:e,id:a,hasChildren:o,defaultCollapseState:this.getDefaultCollapseState(t)});return s&&s.viewState.focus&&s.viewState.focus.indexOf(a)>-1&&s.focus.push(c),s&&s.viewState.selection&&s.viewState.selection.indexOf(a)>-1&&s.selection.push(c),(s&&s.viewState.expanded&&s.viewState.expanded.indexOf(a)>-1||o&&c.defaultCollapseState===l.kn.PreserveOrExpanded)&&d.push(c),c}));for(const e of n.values())k(e,(e=>this.nodes.delete(e.element)));for(const e of a)this.nodes.set(e.element,e);return e.children.splice(0,e.children.length,...a),e!==this.root&&this.autoExpandSingleChildren&&1===a.length&&0===d.length&&(a[0].forceExpanded=!0,d.push(a[0])),d}render(e,t,i){const s=e.children.map((e=>this.asTreeElement(e,t))),o=i&&{...i,diffIdentityProvider:i.diffIdentityProvider&&{getId:e=>i.diffIdentityProvider.getId(e.element)}};this.tree.setChildren(e===this.root?null:e,s,o),e!==this.root&&this.tree.setCollapsible(e,e.hasChildren),this._onDidRender.fire()}asTreeElement(e,t){if(e.stale)return{element:e,collapsible:e.hasChildren,collapsed:!0};let i;return t&&t.viewState.expanded&&e.id&&t.viewState.expanded.indexOf(e.id)>-1?i=!1:e.forceExpanded?(i=!1,e.forceExpanded=!1):i=e.defaultCollapseState,{element:e,children:e.hasChildren?p.$.map(e.children,(e=>this.asTreeElement(e,t))):[],collapsible:e.hasChildren,collapsed:i}}processChildren(e){return this.sorter&&(e=[...e].sort(this.sorter.compare.bind(this.sorter))),e}dispose(){this.disposables.dispose(),this.tree.dispose()}}class P{get element(){return{elements:this.node.element.elements.map((e=>e.element)),incompressible:this.node.element.incompressible}}get children(){return this.node.children.map((e=>new P(e)))}get depth(){return this.node.depth}get visibleChildrenCount(){return this.node.visibleChildrenCount}get visibleChildIndex(){return this.node.visibleChildIndex}get collapsible(){return this.node.collapsible}get collapsed(){return this.node.collapsed}get visible(){return this.node.visible}get filterData(){return this.node.filterData}constructor(e){this.node=e}}class _{constructor(e,t,i,s){this.renderer=e,this.nodeMapper=t,this.compressibleNodeMapperProvider=i,this.onDidChangeTwistieState=s,this.renderedNodes=new Map,this.disposables=[],this.templateId=e.templateId}renderTemplate(e){return{templateData:this.renderer.renderTemplate(e)}}renderElement(e,t,i,s){this.renderer.renderElement(this.nodeMapper.map(e),t,i.templateData,s)}renderCompressedElements(e,t,i,s){this.renderer.renderCompressedElements(this.compressibleNodeMapperProvider().map(e),t,i.templateData,s)}renderTwistie(e,t){return e.slow?(t.classList.add(...h.k.asClassNameArray(a.l.treeItemLoading)),!0):(t.classList.remove(...h.k.asClassNameArray(a.l.treeItemLoading)),!1)}disposeElement(e,t,i,s){var o,n;null===(n=(o=this.renderer).disposeElement)||void 0===n||n.call(o,this.nodeMapper.map(e),t,i.templateData,s)}disposeCompressedElements(e,t,i,s){var o,n;null===(n=(o=this.renderer).disposeCompressedElements)||void 0===n||n.call(o,this.compressibleNodeMapperProvider().map(e),t,i.templateData,s)}disposeTemplate(e){this.renderer.disposeTemplate(e.templateData)}dispose(){this.renderedNodes.clear(),this.disposables=(0,g.B9)(this.disposables)}}class I extends x{constructor(e,t,i,s,o,n,r={}){super(e,t,i,o,n,r),this.compressionDelegate=s,this.compressibleNodeMapper=new l.VA((e=>new P(e))),this.filter=r.filter}createTree(e,t,i,s,n){const l=new o.cz(i),d=s.map((e=>new _(e,this.nodeMapper,(()=>this.compressibleNodeMapper),this._onDidChangeNodeSlowState.event))),a=function(e){const t=e&&E(e);return t&&{...t,keyboardNavigationLabelProvider:t.keyboardNavigationLabelProvider&&{...t.keyboardNavigationLabelProvider,getCompressedNodeKeyboardNavigationLabel:t=>e.keyboardNavigationLabelProvider.getCompressedNodeKeyboardNavigationLabel(t.map((e=>e.element)))}}}(n)||{};return new r.h(e,t,l,d,a)}asTreeElement(e,t){return{incompressible:this.compressionDelegate.isIncompressible(e.element),...super.asTreeElement(e,t)}}updateOptions(e={}){this.tree.updateOptions(e)}render(e,t,i){if(!this.identityProvider)return super.render(e,t);const s=e=>this.identityProvider.getId(e).toString(),o=e=>{const t=new Set;for(const i of e){const e=this.tree.getCompressedTreeNode(i===this.root?null:i);if(e.element)for(const i of e.element.elements)t.add(s(i.element))}return t},n=o(this.tree.getSelection()),r=o(this.tree.getFocus());super.render(e,t,i);const l=this.getSelection();let d=!1;const a=this.getFocus();let h=!1;const c=e=>{const t=e.element;if(t)for(let e=0;e<t.elements.length;e++){const i=s(t.elements[e].element),o=t.elements[t.elements.length-1].element;n.has(i)&&-1===l.indexOf(o)&&(l.push(o),d=!0),r.has(i)&&-1===a.indexOf(o)&&(a.push(o),h=!0)}e.children.forEach(c)};c(this.tree.getCompressedTreeNode(e===this.root?null:e)),d&&this.setSelection(l),h&&this.setFocus(a)}processChildren(e){return this.filter&&(e=p.$.filter(e,(e=>{const t=this.filter.filter(e,1),i="boolean"==typeof(s=t)?s?1:0:(0,n.gB)(s)?(0,n.aG)(s.visibility):(0,n.aG)(s);var s;if(2===i)throw new Error("Recursive tree visibility not supported in async data compressed trees");return 1===i}))),super.processChildren(e)}}},12381:(e,t,i)=>{i.d(t,{UE:()=>v});var s=i(79020),o=i(60350),n=i(9488),r=i(4669),l=i(53725);function d(e){return{element:{elements:[e.element],incompressible:e.incompressible||!1},children:l.$.map(l.$.from(e.children),d),collapsible:e.collapsible,collapsed:e.collapsed}}function a(e){const t=[e.element],i=e.incompressible||!1;let s,o;for(;[o,s]=l.$.consume(l.$.from(e.children),2),1===o.length&&!o[0].incompressible;)e=o[0],t.push(e.element);return{element:{elements:t,incompressible:i},children:l.$.map(l.$.concat(o,s),a),collapsible:e.collapsible,collapsed:e.collapsed}}function h(e,t=0){let i;return i=t<e.element.elements.length-1?[h(e,t+1)]:l.$.map(l.$.from(e.children),(e=>h(e,0))),0===t&&e.element.incompressible?{element:e.element.elements[t],children:i,incompressible:!0,collapsible:e.collapsible,collapsed:e.collapsed}:{element:e.element.elements[t],children:i,collapsible:e.collapsible,collapsed:e.collapsed}}function c(e){return h(e,0)}function u(e,t,i){return e.element===t?{...e,children:i}:{...e,children:l.$.map(l.$.from(e.children),(e=>u(e,t,i)))}}class p{get onDidSplice(){return this.model.onDidSplice}get onDidChangeCollapseState(){return this.model.onDidChangeCollapseState}get onDidChangeRenderNodeCount(){return this.model.onDidChangeRenderNodeCount}constructor(e,t,i={}){this.user=e,this.rootRef=null,this.nodes=new Map,this.model=new s.F(e,t,i),this.enabled=void 0===i.compressionEnabled||i.compressionEnabled,this.identityProvider=i.identityProvider}setChildren(e,t=l.$.empty(),i){const s=i.diffIdentityProvider&&(r=i.diffIdentityProvider,{getId:e=>e.elements.map((e=>r.getId(e).toString())).join("\0")});var r;if(null===e){const e=l.$.map(t,this.enabled?a:d);return void this._setChildren(null,e,{diffIdentityProvider:s,diffDepth:1/0})}const h=this.nodes.get(e);if(!h)throw new o.ac(this.user,"Unknown compressed tree node");const p=this.model.getNode(h),g=this.model.getParentNodeLocation(h),m=this.model.getNode(g),v=u(c(p),e,t),f=(this.enabled?a:d)(v),C=i.diffIdentityProvider?(e,t)=>i.diffIdentityProvider.getId(e)===i.diffIdentityProvider.getId(t):void 0;if((0,n.fS)(f.element.elements,p.element.elements,C))return void this._setChildren(h,f.children||l.$.empty(),{diffIdentityProvider:s,diffDepth:1});const b=m.children.map((e=>e===p?f:e));this._setChildren(m.element,b,{diffIdentityProvider:s,diffDepth:p.depth-m.depth})}isCompressionEnabled(){return this.enabled}setCompressionEnabled(e){if(e===this.enabled)return;this.enabled=e;const t=this.model.getNode().children,i=l.$.map(t,c),s=l.$.map(i,e?a:d);this._setChildren(null,s,{diffIdentityProvider:this.identityProvider,diffDepth:1/0})}_setChildren(e,t,i){const s=new Set;this.model.setChildren(e,t,{...i,onDidCreateNode:e=>{for(const t of e.element.elements)s.add(t),this.nodes.set(t,e.element)},onDidDeleteNode:e=>{for(const t of e.element.elements)s.has(t)||this.nodes.delete(t)}})}has(e){return this.nodes.has(e)}getListIndex(e){const t=this.getCompressedNode(e);return this.model.getListIndex(t)}getListRenderCount(e){const t=this.getCompressedNode(e);return this.model.getListRenderCount(t)}getNode(e){if(void 0===e)return this.model.getNode();const t=this.getCompressedNode(e);return this.model.getNode(t)}getNodeLocation(e){const t=this.model.getNodeLocation(e);return null===t?null:t.elements[t.elements.length-1]}getParentNodeLocation(e){const t=this.getCompressedNode(e),i=this.model.getParentNodeLocation(t);return null===i?null:i.elements[i.elements.length-1]}getFirstElementChild(e){const t=this.getCompressedNode(e);return this.model.getFirstElementChild(t)}isCollapsible(e){const t=this.getCompressedNode(e);return this.model.isCollapsible(t)}setCollapsible(e,t){const i=this.getCompressedNode(e);return this.model.setCollapsible(i,t)}isCollapsed(e){const t=this.getCompressedNode(e);return this.model.isCollapsed(t)}setCollapsed(e,t,i){const s=this.getCompressedNode(e);return this.model.setCollapsed(s,t,i)}expandTo(e){const t=this.getCompressedNode(e);this.model.expandTo(t)}rerender(e){const t=this.getCompressedNode(e);this.model.rerender(t)}refilter(){this.model.refilter()}getCompressedNode(e){if(null===e)return null;const t=this.nodes.get(e);if(!t)throw new o.ac(this.user,`Tree element not found: ${e}`);return t}}const g=e=>e[e.length-1];class m{get element(){return null===this.node.element?null:this.unwrapper(this.node.element)}get children(){return this.node.children.map((e=>new m(this.unwrapper,e)))}get depth(){return this.node.depth}get visibleChildrenCount(){return this.node.visibleChildrenCount}get visibleChildIndex(){return this.node.visibleChildIndex}get collapsible(){return this.node.collapsible}get collapsed(){return this.node.collapsed}get visible(){return this.node.visible}get filterData(){return this.node.filterData}constructor(e,t){this.unwrapper=e,this.node=t}}class v{get onDidSplice(){return r.ju.map(this.model.onDidSplice,(({insertedNodes:e,deletedNodes:t})=>({insertedNodes:e.map((e=>this.nodeMapper.map(e))),deletedNodes:t.map((e=>this.nodeMapper.map(e)))})))}get onDidChangeCollapseState(){return r.ju.map(this.model.onDidChangeCollapseState,(({node:e,deep:t})=>({node:this.nodeMapper.map(e),deep:t})))}get onDidChangeRenderNodeCount(){return r.ju.map(this.model.onDidChangeRenderNodeCount,(e=>this.nodeMapper.map(e)))}constructor(e,t,i={}){this.rootRef=null,this.elementMapper=i.elementMapper||g;const s=e=>this.elementMapper(e.elements);this.nodeMapper=new o.VA((e=>new m(s,e))),this.model=new p(e,function(e,t){return{splice(i,s,o){t.splice(i,s,o.map((t=>e.map(t))))},updateElementHeight(e,i){t.updateElementHeight(e,i)}}}(this.nodeMapper,t),function(e,t){return{...t,identityProvider:t.identityProvider&&{getId:i=>t.identityProvider.getId(e(i))},sorter:t.sorter&&{compare:(e,i)=>t.sorter.compare(e.elements[0],i.elements[0])},filter:t.filter&&{filter:(i,s)=>t.filter.filter(e(i),s)}}}(s,i))}setChildren(e,t=l.$.empty(),i={}){this.model.setChildren(e,t,i)}isCompressionEnabled(){return this.model.isCompressionEnabled()}setCompressionEnabled(e){this.model.setCompressionEnabled(e)}has(e){return this.model.has(e)}getListIndex(e){return this.model.getListIndex(e)}getListRenderCount(e){return this.model.getListRenderCount(e)}getNode(e){return this.nodeMapper.map(this.model.getNode(e))}getNodeLocation(e){return e.element}getParentNodeLocation(e){return this.model.getParentNodeLocation(e)}getFirstElementChild(e){const t=this.model.getFirstElementChild(e);return null==t?t:this.elementMapper(t.elements)}isCollapsible(e){return this.model.isCollapsible(e)}setCollapsible(e,t){return this.model.setCollapsible(e,t)}isCollapsed(e){return this.model.isCollapsed(e)}setCollapsed(e,t,i){return this.model.setCollapsed(e,t,i)}expandTo(e){return this.model.expandTo(e)}rerender(e){return this.model.rerender(e)}refilter(){return this.model.refilter()}getCompressedTreeNode(e=null){return this.model.getNode(e)}}},32481:(e,t,i)=>{i.d(t,{u:()=>n});var s=i(5637),o=i(79020);class n extends s.CH{constructor(e,t,i,s,o,n={}){super(e,t,i,s,n),this.user=e,this.dataSource=o,this.identityProvider=n.identityProvider}createModel(e,t,i){return new o.F(e,t,i)}}},71782:(e,t,i)=>{i.d(t,{X:()=>p,aG:()=>c,gB:()=>h});var s=i(60350),o=i(9488),n=i(15393),r=i(5635),l=i(2484),d=i(4669),a=i(53725);function h(e){return"object"==typeof e&&"visibility"in e&&"data"in e}function c(e){switch(e){case!0:return 1;case!1:return 0;default:return e}}function u(e){return"boolean"==typeof e.collapsible}class p{constructor(e,t,i,s={}){var o;this.user=e,this.list=t,this.rootRef=[],this.eventBufferer=new d.E7,this._onDidChangeCollapseState=new d.Q5,this.onDidChangeCollapseState=this.eventBufferer.wrapEvent(this._onDidChangeCollapseState.event),this._onDidChangeRenderNodeCount=new d.Q5,this.onDidChangeRenderNodeCount=this.eventBufferer.wrapEvent(this._onDidChangeRenderNodeCount.event),this._onDidSplice=new d.Q5,this.onDidSplice=this._onDidSplice.event,this.refilterDelayer=new n.vp(r.n),this.collapseByDefault=void 0!==s.collapseByDefault&&s.collapseByDefault,this.allowNonCollapsibleParents=null!==(o=s.allowNonCollapsibleParents)&&void 0!==o&&o,this.filter=s.filter,this.autoExpandSingleChildren=void 0!==s.autoExpandSingleChildren&&s.autoExpandSingleChildren,this.root={parent:void 0,element:i,children:[],depth:0,visibleChildrenCount:0,visibleChildIndex:-1,collapsible:!1,collapsed:!1,renderNodeCount:0,visibility:1,visible:!0,filterData:void 0}}splice(e,t,i=a.$.empty(),o={}){if(0===e.length)throw new s.ac(this.user,"Invalid tree location");o.diffIdentityProvider?this.spliceSmart(o.diffIdentityProvider,e,t,i,o):this.spliceSimple(e,t,i,o)}spliceSmart(e,t,i,s,o,n){var r;void 0===s&&(s=a.$.empty()),void 0===n&&(n=null!==(r=o.diffDepth)&&void 0!==r?r:0);const{parentNode:d}=this.getParentNodeWithListIndex(t);if(!d.lastDiffIds)return this.spliceSimple(t,i,s,o);const h=[...s],c=t[t.length-1],u=new l.Hs({getElements:()=>d.lastDiffIds},{getElements:()=>[...d.children.slice(0,c),...h,...d.children.slice(c+i)].map((t=>e.getId(t.element).toString()))}).ComputeDiff(!1);if(u.quitEarly)return d.lastDiffIds=void 0,this.spliceSimple(t,i,h,o);const p=t.slice(0,-1),g=(t,i,s)=>{if(n>0)for(let r=0;r<s;r++)t--,i--,this.spliceSmart(e,[...p,t,0],Number.MAX_SAFE_INTEGER,h[i].children,o,n-1)};let m=Math.min(d.children.length,c+i),v=h.length;for(const e of u.changes.sort(((e,t)=>t.originalStart-e.originalStart)))g(m,v,m-(e.originalStart+e.originalLength)),m=e.originalStart,v=e.modifiedStart-c,this.spliceSimple([...p,m],e.originalLength,a.$.slice(h,v,v+e.modifiedLength),o);g(m,v,m)}spliceSimple(e,t,i=a.$.empty(),{onDidCreateNode:s,onDidDeleteNode:n,diffIdentityProvider:r}){const{parentNode:l,listIndex:d,revealed:h,visible:c}=this.getParentNodeWithListIndex(e),u=[],p=a.$.map(i,(e=>this.createTreeNode(e,l,l.visible?1:0,h,u,s))),g=e[e.length-1];let m=0;for(let e=g;e>=0&&e<l.children.length;e--){const t=l.children[e];if(t.visible){m=t.visibleChildIndex;break}}const v=[];let f=0,C=0;for(const e of p)v.push(e),C+=e.renderNodeCount,e.visible&&(e.visibleChildIndex=m+f++);const b=(0,o.db)(l.children,g,t,v);r?l.lastDiffIds?(0,o.db)(l.lastDiffIds,g,t,v.map((e=>r.getId(e.element).toString()))):l.lastDiffIds=l.children.map((e=>r.getId(e.element).toString())):l.lastDiffIds=void 0;let w=0;for(const e of b)e.visible&&w++;if(0!==w)for(let e=g+v.length;e<l.children.length;e++){const t=l.children[e];t.visible&&(t.visibleChildIndex-=w)}if(l.visibleChildrenCount+=f-w,h&&c){const e=b.reduce(((e,t)=>e+(t.visible?t.renderNodeCount:0)),0);this._updateAncestorsRenderNodeCount(l,C-e),this.list.splice(d,e,u)}if(b.length>0&&n){const e=t=>{n(t),t.children.forEach(e)};b.forEach(e)}this._onDidSplice.fire({insertedNodes:v,deletedNodes:b});let y=l;for(;y;){if(2===y.visibility){this.refilterDelayer.trigger((()=>this.refilter()));break}y=y.parent}}rerender(e){if(0===e.length)throw new s.ac(this.user,"Invalid tree location");const{node:t,listIndex:i,revealed:o}=this.getTreeNodeWithListIndex(e);t.visible&&o&&this.list.splice(i,1,[t])}has(e){return this.hasTreeNode(e)}getListIndex(e){const{listIndex:t,visible:i,revealed:s}=this.getTreeNodeWithListIndex(e);return i&&s?t:-1}getListRenderCount(e){return this.getTreeNode(e).renderNodeCount}isCollapsible(e){return this.getTreeNode(e).collapsible}setCollapsible(e,t){const i=this.getTreeNode(e);void 0===t&&(t=!i.collapsible);const s={collapsible:t};return this.eventBufferer.bufferEvents((()=>this._setCollapseState(e,s)))}isCollapsed(e){return this.getTreeNode(e).collapsed}setCollapsed(e,t,i){const s=this.getTreeNode(e);void 0===t&&(t=!s.collapsed);const o={collapsed:t,recursive:i||!1};return this.eventBufferer.bufferEvents((()=>this._setCollapseState(e,o)))}_setCollapseState(e,t){const{node:i,listIndex:s,revealed:o}=this.getTreeNodeWithListIndex(e),n=this._setListNodeCollapseState(i,s,o,t);if(i!==this.root&&this.autoExpandSingleChildren&&n&&!u(t)&&i.collapsible&&!i.collapsed&&!t.recursive){let s=-1;for(let e=0;e<i.children.length;e++){if(i.children[e].visible){if(s>-1){s=-1;break}s=e}}s>-1&&this._setCollapseState([...e,s],t)}return n}_setListNodeCollapseState(e,t,i,s){const o=this._setNodeCollapseState(e,s,!1);if(!i||!e.visible||!o)return o;const n=e.renderNodeCount,r=this.updateNodeAfterCollapseChange(e),l=n-(-1===t?0:1);return this.list.splice(t+1,l,r.slice(1)),o}_setNodeCollapseState(e,t,i){let s;if(e===this.root?s=!1:(u(t)?(s=e.collapsible!==t.collapsible,e.collapsible=t.collapsible):e.collapsible?(s=e.collapsed!==t.collapsed,e.collapsed=t.collapsed):s=!1,s&&this._onDidChangeCollapseState.fire({node:e,deep:i})),!u(t)&&t.recursive)for(const i of e.children)s=this._setNodeCollapseState(i,t,!0)||s;return s}expandTo(e){this.eventBufferer.bufferEvents((()=>{let t=this.getTreeNode(e);for(;t.parent;)t=t.parent,e=e.slice(0,e.length-1),t.collapsed&&this._setCollapseState(e,{collapsed:!1,recursive:!1})}))}refilter(){const e=this.root.renderNodeCount,t=this.updateNodeAfterFilterChange(this.root);this.list.splice(0,e,t),this.refilterDelayer.cancel()}createTreeNode(e,t,i,s,o,n){const r={parent:t,element:e.element,children:[],depth:t.depth+1,visibleChildrenCount:0,visibleChildIndex:-1,collapsible:"boolean"==typeof e.collapsible?e.collapsible:void 0!==e.collapsed,collapsed:void 0===e.collapsed?this.collapseByDefault:e.collapsed,renderNodeCount:1,visibility:1,visible:!0,filterData:void 0},l=this._filterNode(r,i);r.visibility=l,s&&o.push(r);const d=e.children||a.$.empty(),h=s&&0!==l&&!r.collapsed;let c=0,u=1;for(const e of d){const t=this.createTreeNode(e,r,l,h,o,n);r.children.push(t),u+=t.renderNodeCount,t.visible&&(t.visibleChildIndex=c++)}return this.allowNonCollapsibleParents||(r.collapsible=r.collapsible||r.children.length>0),r.visibleChildrenCount=c,r.visible=2===l?c>0:1===l,r.visible?r.collapsed||(r.renderNodeCount=u):(r.renderNodeCount=0,s&&o.pop()),null==n||n(r),r}updateNodeAfterCollapseChange(e){const t=e.renderNodeCount,i=[];return this._updateNodeAfterCollapseChange(e,i),this._updateAncestorsRenderNodeCount(e.parent,i.length-t),i}_updateNodeAfterCollapseChange(e,t){if(!1===e.visible)return 0;if(t.push(e),e.renderNodeCount=1,!e.collapsed)for(const i of e.children)e.renderNodeCount+=this._updateNodeAfterCollapseChange(i,t);return this._onDidChangeRenderNodeCount.fire(e),e.renderNodeCount}updateNodeAfterFilterChange(e){const t=e.renderNodeCount,i=[];return this._updateNodeAfterFilterChange(e,e.visible?1:0,i),this._updateAncestorsRenderNodeCount(e.parent,i.length-t),i}_updateNodeAfterFilterChange(e,t,i,s=!0){let o;if(e!==this.root){if(o=this._filterNode(e,t),0===o)return e.visible=!1,e.renderNodeCount=0,!1;s&&i.push(e)}const n=i.length;e.renderNodeCount=e===this.root?0:1;let r=!1;if(e.collapsed&&0===o)e.visibleChildrenCount=0;else{let t=0;for(const n of e.children)r=this._updateNodeAfterFilterChange(n,o,i,s&&!e.collapsed)||r,n.visible&&(n.visibleChildIndex=t++);e.visibleChildrenCount=t}return e!==this.root&&(e.visible=2===o?r:1===o,e.visibility=o),e.visible?e.collapsed||(e.renderNodeCount+=i.length-n):(e.renderNodeCount=0,s&&i.pop()),this._onDidChangeRenderNodeCount.fire(e),e.visible}_updateAncestorsRenderNodeCount(e,t){if(0!==t)for(;e;)e.renderNodeCount+=t,this._onDidChangeRenderNodeCount.fire(e),e=e.parent}_filterNode(e,t){const i=this.filter?this.filter.filter(e.element,t):1;return"boolean"==typeof i?(e.filterData=void 0,i?1:0):h(i)?(e.filterData=i.data,c(i.visibility)):(e.filterData=void 0,c(i))}hasTreeNode(e,t=this.root){if(!e||0===e.length)return!0;const[i,...s]=e;return!(i<0||i>t.children.length)&&this.hasTreeNode(s,t.children[i])}getTreeNode(e,t=this.root){if(!e||0===e.length)return t;const[i,...o]=e;if(i<0||i>t.children.length)throw new s.ac(this.user,"Invalid tree location");return this.getTreeNode(o,t.children[i])}getTreeNodeWithListIndex(e){if(0===e.length)return{node:this.root,listIndex:-1,revealed:!0,visible:!1};const{parentNode:t,listIndex:i,revealed:o,visible:n}=this.getParentNodeWithListIndex(e),r=e[e.length-1];if(r<0||r>t.children.length)throw new s.ac(this.user,"Invalid tree location");const l=t.children[r];return{node:l,listIndex:i,revealed:o,visible:n&&l.visible}}getParentNodeWithListIndex(e,t=this.root,i=0,o=!0,n=!0){const[r,...l]=e;if(r<0||r>t.children.length)throw new s.ac(this.user,"Invalid tree location");for(let e=0;e<r;e++)i+=t.children[e].renderNodeCount;return o=o&&!t.collapsed,n=n&&t.visible,0===l.length?{parentNode:t,listIndex:i,revealed:o,visible:n}:this.getParentNodeWithListIndex(l,t.children[r],i+1,o,n)}getNode(e=[]){return this.getTreeNode(e)}getNodeLocation(e){const t=[];let i=e;for(;i.parent;)t.push(i.parent.children.indexOf(i)),i=i.parent;return t.reverse()}getParentNodeLocation(e){return 0===e.length?void 0:1===e.length?[]:(0,o.JH)(e)[0]}getFirstElementChild(e){const t=this.getTreeNode(e);if(0!==t.children.length)return t.children[0].element}}}}]);